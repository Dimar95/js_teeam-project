(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const na={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};const g=function(n,e){if(!n)throw bt(e)},bt=function(n){return new Error("Firebase Database ("+na.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};const ia=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},ou=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=n[t++];e[i++]=String.fromCharCode((s&31)<<6|r&63)}else if(s>239&&s<365){const r=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const r=n[t++],o=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(r&63)<<6|o&63)}}return e.join("")},Ts={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const r=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,u=r>>2,d=(r&3)<<4|a>>4;let h=(a&15)<<2|c>>6,m=c&63;l||(m=64,o||(h=64)),i.push(t[u],t[d],t[h],t[m])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ia(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):ou(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const r=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const d=s<n.length?t[n.charAt(s)]:64;if(++s,r==null||a==null||c==null||d==null)throw Error();const h=r<<2|a>>4;if(i.push(h),c!==64){const m=a<<4&240|c>>2;if(i.push(m),d!==64){const p=c<<6&192|d;i.push(p)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},sa=function(n){const e=ia(n);return Ts.encodeByteArray(e,!0)},On=function(n){return sa(n).replace(/\./g,"")},Pn=function(n){try{return Ts.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function au(n){return ra(void 0,n)}function ra(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!lu(t)||(n[t]=ra(n[t],e[t]));return n}function lu(n){return n!=="__proto__"}function cu(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const uu=()=>cu().__FIREBASE_DEFAULTS__,du=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},hu=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Pn(n[1]);return e&&JSON.parse(e)},Ss=()=>{try{return uu()||du()||hu()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},oa=n=>{var e,t;return(t=(e=Ss())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},fu=n=>{const e=oa(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},pu=()=>{var n;return(n=Ss())===null||n===void 0?void 0:n.config},aa=n=>{var e;return(e=Ss())===null||e===void 0?void 0:e[`_${n}`]};class ii{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function mu(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,r=n.sub||n.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},n),a="";return[On(JSON.stringify(t)),On(JSON.stringify(o)),a].join(".")}function V(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ks(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(V())}function la(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function ca(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function gu(){const n=V();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function ua(){return na.NODE_ADMIN===!0}function da(){try{return typeof indexedDB=="object"}catch{return!1}}function ha(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var r;e(((r=s.error)===null||r===void 0?void 0:r.message)||"")}}catch(t){e(t)}})}function _u(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const yu="FirebaseError";class _e extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=yu,Object.setPrototypeOf(this,_e.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,rt.prototype.create)}}class rt{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,r=this.errors[e],o=r?vu(r,i):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new _e(s,a,i)}}function vu(n,e){return n.replace(wu,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const wu=/\{\$([^}]+)}/g;function jt(n){return JSON.parse(n)}function L(n){return JSON.stringify(n)}const fa=function(n){let e={},t={},i={},s="";try{const r=n.split(".");e=jt(Pn(r[0])||""),t=jt(Pn(r[1])||""),s=r[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:s}},bu=function(n){const e=fa(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},Iu=function(n){const e=fa(n).claims;return typeof e=="object"&&e.admin===!0};function Te(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function gt(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function es(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Dn(n,e,t){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=e.call(t,n[s],s,n));return i}function zt(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const r=n[s],o=e[s];if(Or(r)&&Or(o)){if(!zt(r,o))return!1}else if(r!==o)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function Or(n){return n!==null&&typeof n=="object"}function It(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Dt(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,r]=i.split("=");e[decodeURIComponent(s)]=decodeURIComponent(r)}}),e}function Mt(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}class Eu{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)i[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)i[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){const h=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=(h<<1|h>>>31)&4294967295}let s=this.chain_[0],r=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,u;for(let d=0;d<80;d++){d<40?d<20?(c=a^r&(o^a),u=1518500249):(c=r^o^a,u=1859775393):d<60?(c=r&o|a&(r|o),u=2400959708):(c=r^o^a,u=3395469782);const h=(s<<5|s>>>27)+c+l+u+i[d]&4294967295;l=a,a=o,o=(r<<30|r>>>2)&4294967295,r=s,s=h}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let s=0;const r=this.buf_;let o=this.inbuf_;for(;s<t;){if(o===0)for(;s<=i;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(r[o]=e.charCodeAt(s),++o,++s,o===this.blockSize){this.compress_(r),o=0;break}}else for(;s<t;)if(r[o]=e[s],++o,++s,o===this.blockSize){this.compress_(r),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let r=24;r>=0;r-=8)e[i]=this.chain_[s]>>r&255,++i;return e}}function Cu(n,e){const t=new Tu(n,e);return t.subscribe.bind(t)}class Tu{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let s;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Su(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:i},s.next===void 0&&(s.next=Ai),s.error===void 0&&(s.error=Ai),s.complete===void 0&&(s.complete=Ai);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Su(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ai(){}function Rs(n,e){return`${n} failed: ${e} argument `}const ku=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const r=s-55296;i++,g(i<n.length,"Surrogate pair missing trail surrogate.");const o=n.charCodeAt(i)-56320;s=65536+(r<<10)+o}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},si=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};const Ru=1e3,Nu=2,Au=4*60*60*1e3,xu=.5;function Pr(n,e=Ru,t=Nu){const i=e*Math.pow(t,n),s=Math.round(xu*i*(Math.random()-.5)*2);return Math.min(Au,i+s)}function K(n){return n&&n._delegate?n._delegate:n}class ce{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ze="[DEFAULT]";class Ou{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new ii;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Du(e))try{this.getOrInitializeService({instanceIdentifier:ze})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const r=this.getOrInitializeService({instanceIdentifier:s});i.resolve(r)}catch{}}}}clearInstance(e=ze){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ze){return this.instances.has(e)}getOptions(e=ze){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);i===a&&o.resolve(s)}return s}onInit(e,t){var i;const s=this.normalizeInstanceIdentifier(t),r=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;r.add(e),this.onInitCallbacks.set(s,r);const o=this.instances.get(s);return o&&e(o,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Pu(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=ze){return this.component?this.component.multipleInstances?e:ze:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Pu(n){return n===ze?void 0:n}function Du(n){return n.instantiationMode==="EAGER"}class Mu{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Ou(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var A;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(A||(A={}));const Lu={debug:A.DEBUG,verbose:A.VERBOSE,info:A.INFO,warn:A.WARN,error:A.ERROR,silent:A.SILENT},Fu=A.INFO,Uu={[A.DEBUG]:"log",[A.VERBOSE]:"log",[A.INFO]:"info",[A.WARN]:"warn",[A.ERROR]:"error"},Bu=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=Uu[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ri{constructor(e){this.name=e,this._logLevel=Fu,this._logHandler=Bu,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in A))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Lu[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,A.DEBUG,...e),this._logHandler(this,A.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,A.VERBOSE,...e),this._logHandler(this,A.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,A.INFO,...e),this._logHandler(this,A.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,A.WARN,...e),this._logHandler(this,A.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,A.ERROR,...e),this._logHandler(this,A.ERROR,...e)}}const Wu=(n,e)=>e.some(t=>n instanceof t);let Dr,Mr;function Hu(){return Dr||(Dr=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ju(){return Mr||(Mr=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const pa=new WeakMap,ts=new WeakMap,ma=new WeakMap,xi=new WeakMap,Ns=new WeakMap;function zu(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",r),n.removeEventListener("error",o)},r=()=>{t(Me(n.result)),s()},o=()=>{i(n.error),s()};n.addEventListener("success",r),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&pa.set(t,n)}).catch(()=>{}),Ns.set(e,n),e}function $u(n){if(ts.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",o),n.removeEventListener("abort",o)},r=()=>{t(),s()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",r),n.addEventListener("error",o),n.addEventListener("abort",o)});ts.set(n,e)}let ns={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ts.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ma.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Me(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Vu(n){ns=n(ns)}function qu(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Oi(this),e,...t);return ma.set(i,e.sort?e.sort():[e]),Me(i)}:ju().includes(n)?function(...e){return n.apply(Oi(this),e),Me(pa.get(this))}:function(...e){return Me(n.apply(Oi(this),e))}}function Gu(n){return typeof n=="function"?qu(n):(n instanceof IDBTransaction&&$u(n),Wu(n,Hu())?new Proxy(n,ns):n)}function Me(n){if(n instanceof IDBRequest)return zu(n);if(xi.has(n))return xi.get(n);const e=Gu(n);return e!==n&&(xi.set(n,e),Ns.set(e,n)),e}const Oi=n=>Ns.get(n);function ga(n,e,{blocked:t,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(n,e),a=Me(o);return i&&o.addEventListener("upgradeneeded",l=>{i(Me(o.result),l.oldVersion,l.newVersion,Me(o.transaction))}),t&&o.addEventListener("blocked",()=>t()),a.then(l=>{r&&l.addEventListener("close",()=>r()),s&&l.addEventListener("versionchange",()=>s())}).catch(()=>{}),a}const Ku=["get","getKey","getAll","getAllKeys","count"],Yu=["put","add","delete","clear"],Pi=new Map;function Lr(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Pi.get(e))return Pi.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=Yu.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||Ku.includes(t)))return;const r=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return Pi.set(e,r),r}Vu(n=>({...n,get:(e,t,i)=>Lr(e,t)||n.get(e,t,i),has:(e,t)=>!!Lr(e,t)||n.has(e,t)}));class Ju{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Qu(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Qu(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const is="@firebase/app",Fr="0.9.3";const Je=new ri("@firebase/app"),Xu="@firebase/app-compat",Zu="@firebase/analytics-compat",ed="@firebase/analytics",td="@firebase/app-check-compat",nd="@firebase/app-check",id="@firebase/auth",sd="@firebase/auth-compat",rd="@firebase/database",od="@firebase/database-compat",ad="@firebase/functions",ld="@firebase/functions-compat",cd="@firebase/installations",ud="@firebase/installations-compat",dd="@firebase/messaging",hd="@firebase/messaging-compat",fd="@firebase/performance",pd="@firebase/performance-compat",md="@firebase/remote-config",gd="@firebase/remote-config-compat",_d="@firebase/storage",yd="@firebase/storage-compat",vd="@firebase/firestore",wd="@firebase/firestore-compat",bd="firebase",Id="9.17.1";const ss="[DEFAULT]",Ed={[is]:"fire-core",[Xu]:"fire-core-compat",[ed]:"fire-analytics",[Zu]:"fire-analytics-compat",[nd]:"fire-app-check",[td]:"fire-app-check-compat",[id]:"fire-auth",[sd]:"fire-auth-compat",[rd]:"fire-rtdb",[od]:"fire-rtdb-compat",[ad]:"fire-fn",[ld]:"fire-fn-compat",[cd]:"fire-iid",[ud]:"fire-iid-compat",[dd]:"fire-fcm",[hd]:"fire-fcm-compat",[fd]:"fire-perf",[pd]:"fire-perf-compat",[md]:"fire-rc",[gd]:"fire-rc-compat",[_d]:"fire-gcs",[yd]:"fire-gcs-compat",[vd]:"fire-fst",[wd]:"fire-fst-compat","fire-js":"fire-js",[bd]:"fire-js-all"};const Mn=new Map,rs=new Map;function Cd(n,e){try{n.container.addComponent(e)}catch(t){Je.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function me(n){const e=n.name;if(rs.has(e))return Je.debug(`There were multiple attempts to register component ${e}.`),!1;rs.set(e,n);for(const t of Mn.values())Cd(t,n);return!0}function ot(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}const Td={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Le=new rt("app","Firebase",Td);class Sd{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ce("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Le.create("app-deleted",{appName:this._name})}}const sn=Id;function As(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:ss,automaticDataCollectionEnabled:!1},e),s=i.name;if(typeof s!="string"||!s)throw Le.create("bad-app-name",{appName:String(s)});if(t||(t=pu()),!t)throw Le.create("no-options");const r=Mn.get(s);if(r){if(zt(t,r.options)&&zt(i,r.config))return r;throw Le.create("duplicate-app",{appName:s})}const o=new Mu(s);for(const l of rs.values())o.addComponent(l);const a=new Sd(t,i,o);return Mn.set(s,a),a}function xs(n=ss){const e=Mn.get(n);if(!e&&n===ss)return As();if(!e)throw Le.create("no-app",{appName:n});return e}function te(n,e,t){var i;let s=(i=Ed[n])!==null&&i!==void 0?i:n;t&&(s+=`-${t}`);const r=s.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const a=[`Unable to register library "${s}" with version "${e}":`];r&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Je.warn(a.join(" "));return}me(new ce(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const kd="firebase-heartbeat-database",Rd=1,$t="firebase-heartbeat-store";let Di=null;function _a(){return Di||(Di=ga(kd,Rd,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore($t)}}}).catch(n=>{throw Le.create("idb-open",{originalErrorMessage:n.message})})),Di}async function Nd(n){try{return(await _a()).transaction($t).objectStore($t).get(ya(n))}catch(e){if(e instanceof _e)Je.warn(e.message);else{const t=Le.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Je.warn(t.message)}}}async function Ur(n,e){try{const i=(await _a()).transaction($t,"readwrite");return await i.objectStore($t).put(e,ya(n)),i.done}catch(t){if(t instanceof _e)Je.warn(t.message);else{const i=Le.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Je.warn(i.message)}}}function ya(n){return`${n.name}!${n.options.appId}`}const Ad=1024,xd=30*24*60*60*1e3;class Od{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Dd(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Br();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(s=>s.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const r=new Date(s.date).valueOf();return Date.now()-r<=xd}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Br(),{heartbeatsToSend:t,unsentEntries:i}=Pd(this._heartbeatsCache.heartbeats),s=On(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Br(){return new Date().toISOString().substring(0,10)}function Pd(n,e=Ad){const t=[];let i=n.slice();for(const s of n){const r=t.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),Wr(t)>e){r.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Wr(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class Dd{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return da()?ha().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Nd(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ur(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ur(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Wr(n){return On(JSON.stringify({version:2,heartbeats:n})).length}function Md(n){me(new ce("platform-logger",e=>new Ju(e),"PRIVATE")),me(new ce("heartbeat",e=>new Od(e),"PRIVATE")),te(is,Fr,n),te(is,Fr,"esm2017"),te("fire-js","")}Md("");var Ld="firebase",Fd="9.17.1";te(Ld,Fd,"app");const va="@firebase/installations",Os="0.6.3";const wa=1e4,ba=`w:${Os}`,Ia="FIS_v2",Ud="https://firebaseinstallations.googleapis.com/v1",Bd=60*60*1e3,Wd="installations",Hd="Installations";const jd={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["not-registered"]:"Firebase Installation is not registered.",["installation-not-found"]:"Firebase Installation not found.",["request-failed"]:'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',["app-offline"]:"Could not process request. Application offline.",["delete-pending-registration"]:"Can't delete installation while there is a pending registration request."},Qe=new rt(Wd,Hd,jd);function Ea(n){return n instanceof _e&&n.code.includes("request-failed")}function Ca({projectId:n}){return`${Ud}/projects/${n}/installations`}function Ta(n){return{token:n.token,requestStatus:2,expiresIn:$d(n.expiresIn),creationTime:Date.now()}}async function Sa(n,e){const i=(await e.json()).error;return Qe.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function ka({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function zd(n,{refreshToken:e}){const t=ka(n);return t.append("Authorization",Vd(e)),t}async function Ra(n){const e=await n();return e.status>=500&&e.status<600?n():e}function $d(n){return Number(n.replace("s","000"))}function Vd(n){return`${Ia} ${n}`}async function qd({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=Ca(n),s=ka(n),r=e.getImmediate({optional:!0});if(r){const c=await r.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={fid:t,authVersion:Ia,appId:n.appId,sdkVersion:ba},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await Ra(()=>fetch(i,a));if(l.ok){const c=await l.json();return{fid:c.fid||t,registrationStatus:2,refreshToken:c.refreshToken,authToken:Ta(c.authToken)}}else throw await Sa("Create Installation",l)}function Na(n){return new Promise(e=>{setTimeout(e,n)})}function Gd(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}const Kd=/^[cdef][\w-]{21}$/,os="";function Yd(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=Jd(n);return Kd.test(t)?t:os}catch{return os}}function Jd(n){return Gd(n).substr(0,22)}function oi(n){return`${n.appName}!${n.appId}`}const Aa=new Map;function xa(n,e){const t=oi(n);Oa(t,e),Qd(t,e)}function Oa(n,e){const t=Aa.get(n);if(t)for(const i of t)i(e)}function Qd(n,e){const t=Xd();t&&t.postMessage({key:n,fid:e}),Zd()}let Ve=null;function Xd(){return!Ve&&"BroadcastChannel"in self&&(Ve=new BroadcastChannel("[Firebase] FID Change"),Ve.onmessage=n=>{Oa(n.data.key,n.data.fid)}),Ve}function Zd(){Aa.size===0&&Ve&&(Ve.close(),Ve=null)}const eh="firebase-installations-database",th=1,Xe="firebase-installations-store";let Mi=null;function Ps(){return Mi||(Mi=ga(eh,th,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Xe)}}})),Mi}async function Ln(n,e){const t=oi(n),s=(await Ps()).transaction(Xe,"readwrite"),r=s.objectStore(Xe),o=await r.get(t);return await r.put(e,t),await s.done,(!o||o.fid!==e.fid)&&xa(n,e.fid),e}async function Pa(n){const e=oi(n),i=(await Ps()).transaction(Xe,"readwrite");await i.objectStore(Xe).delete(e),await i.done}async function ai(n,e){const t=oi(n),s=(await Ps()).transaction(Xe,"readwrite"),r=s.objectStore(Xe),o=await r.get(t),a=e(o);return a===void 0?await r.delete(t):await r.put(a,t),await s.done,a&&(!o||o.fid!==a.fid)&&xa(n,a.fid),a}async function Ds(n){let e;const t=await ai(n.appConfig,i=>{const s=nh(i),r=ih(n,s);return e=r.registrationPromise,r.installationEntry});return t.fid===os?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function nh(n){const e=n||{fid:Yd(),registrationStatus:0};return Da(e)}function ih(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Qe.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=sh(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:rh(n)}:{installationEntry:e}}async function sh(n,e){try{const t=await qd(n,e);return Ln(n.appConfig,t)}catch(t){throw Ea(t)&&t.customData.serverCode===409?await Pa(n.appConfig):await Ln(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function rh(n){let e=await Hr(n.appConfig);for(;e.registrationStatus===1;)await Na(100),e=await Hr(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await Ds(n);return i||t}return e}function Hr(n){return ai(n,e=>{if(!e)throw Qe.create("installation-not-found");return Da(e)})}function Da(n){return oh(n)?{fid:n.fid,registrationStatus:0}:n}function oh(n){return n.registrationStatus===1&&n.registrationTime+wa<Date.now()}async function ah({appConfig:n,heartbeatServiceProvider:e},t){const i=lh(n,t),s=zd(n,t),r=e.getImmediate({optional:!0});if(r){const c=await r.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={installation:{sdkVersion:ba,appId:n.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await Ra(()=>fetch(i,a));if(l.ok){const c=await l.json();return Ta(c)}else throw await Sa("Generate Auth Token",l)}function lh(n,{fid:e}){return`${Ca(n)}/${e}/authTokens:generate`}async function Ms(n,e=!1){let t;const i=await ai(n.appConfig,r=>{if(!Ma(r))throw Qe.create("not-registered");const o=r.authToken;if(!e&&dh(o))return r;if(o.requestStatus===1)return t=ch(n,e),r;{if(!navigator.onLine)throw Qe.create("app-offline");const a=fh(r);return t=uh(n,a),a}});return t?await t:i.authToken}async function ch(n,e){let t=await jr(n.appConfig);for(;t.authToken.requestStatus===1;)await Na(100),t=await jr(n.appConfig);const i=t.authToken;return i.requestStatus===0?Ms(n,e):i}function jr(n){return ai(n,e=>{if(!Ma(e))throw Qe.create("not-registered");const t=e.authToken;return ph(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function uh(n,e){try{const t=await ah(n,e),i=Object.assign(Object.assign({},e),{authToken:t});return await Ln(n.appConfig,i),t}catch(t){if(Ea(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await Pa(n.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Ln(n.appConfig,i)}throw t}}function Ma(n){return n!==void 0&&n.registrationStatus===2}function dh(n){return n.requestStatus===2&&!hh(n)}function hh(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+Bd}function fh(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function ph(n){return n.requestStatus===1&&n.requestTime+wa<Date.now()}async function mh(n){const e=n,{installationEntry:t,registrationPromise:i}=await Ds(e);return i?i.catch(console.error):Ms(e).catch(console.error),t.fid}async function gh(n,e=!1){const t=n;return await _h(t),(await Ms(t,e)).token}async function _h(n){const{registrationPromise:e}=await Ds(n);e&&await e}function yh(n){if(!n||!n.options)throw Li("App Configuration");if(!n.name)throw Li("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Li(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Li(n){return Qe.create("missing-app-config-values",{valueName:n})}const La="installations",vh="installations-internal",wh=n=>{const e=n.getProvider("app").getImmediate(),t=yh(e),i=ot(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},bh=n=>{const e=n.getProvider("app").getImmediate(),t=ot(e,La).getImmediate();return{getId:()=>mh(t),getToken:s=>gh(t,s)}};function Ih(){me(new ce(La,wh,"PUBLIC")),me(new ce(vh,bh,"PRIVATE"))}Ih();te(va,Os);te(va,Os,"esm2017");const Fn="analytics",Eh="firebase_id",Ch="origin",Th=60*1e3,Sh="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Fa="https://www.googletagmanager.com/gtag/js";const Z=new ri("@firebase/analytics");function Ua(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function kh(n,e){const t=document.createElement("script");t.src=`${Fa}?l=${n}&id=${e}`,t.async=!0,document.head.appendChild(t)}function Rh(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function Nh(n,e,t,i,s,r){const o=i[s];try{if(o)await e[o];else{const l=(await Ua(t)).find(c=>c.measurementId===s);l&&await e[l.appId]}}catch(a){Z.error(a)}n("config",s,r)}async function Ah(n,e,t,i,s){try{let r=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await Ua(t);for(const l of o){const c=a.find(d=>d.measurementId===l),u=c&&e[c.appId];if(u)r.push(u);else{r=[];break}}}r.length===0&&(r=Object.values(e)),await Promise.all(r),n("event",i,s||{})}catch(r){Z.error(r)}}function xh(n,e,t,i){async function s(r,o,a){try{r==="event"?await Ah(n,e,t,o,a):r==="config"?await Nh(n,e,t,i,o,a):r==="consent"?n("consent","update",a):n("set",o)}catch(l){Z.error(l)}}return s}function Oh(n,e,t,i,s){let r=function(...o){window[i].push(arguments)};return window[s]&&typeof window[s]=="function"&&(r=window[s]),window[s]=xh(r,n,e,t),{gtagCore:r,wrappedGtag:window[s]}}function Ph(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Fa)&&t.src.includes(n))return t;return null}const Dh={["already-exists"]:"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",["already-initialized"]:"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.",["already-initialized-settings"]:"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",["interop-component-reg-failed"]:"Firebase Analytics Interop Component failed to instantiate: {$reason}",["invalid-analytics-context"]:"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["indexeddb-unavailable"]:"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["fetch-throttle"]:"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",["config-fetch-failed"]:"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",["no-api-key"]:'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',["no-app-id"]:'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},ne=new rt("analytics","Analytics",Dh);const Mh=30,Lh=1e3;class Fh{constructor(e={},t=Lh){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const Ba=new Fh;function Uh(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function Bh(n){var e;const{appId:t,apiKey:i}=n,s={method:"GET",headers:Uh(i)},r=Sh.replace("{app-id}",t),o=await fetch(r,s);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw ne.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function Wh(n,e=Ba,t){const{appId:i,apiKey:s,measurementId:r}=n.options;if(!i)throw ne.create("no-app-id");if(!s){if(r)return{measurementId:r,appId:i};throw ne.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new zh;return setTimeout(async()=>{a.abort()},t!==void 0?t:Th),Wa({appId:i,apiKey:s,measurementId:r},o,a,e)}async function Wa(n,{throttleEndTimeMillis:e,backoffCount:t},i,s=Ba){var r;const{appId:o,measurementId:a}=n;try{await Hh(i,e)}catch(l){if(a)return Z.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw l}try{const l=await Bh(n);return s.deleteThrottleMetadata(o),l}catch(l){const c=l;if(!jh(c)){if(s.deleteThrottleMetadata(o),a)return Z.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:a};throw l}const u=Number((r=c==null?void 0:c.customData)===null||r===void 0?void 0:r.httpStatus)===503?Pr(t,s.intervalMillis,Mh):Pr(t,s.intervalMillis),d={throttleEndTimeMillis:Date.now()+u,backoffCount:t+1};return s.setThrottleMetadata(o,d),Z.debug(`Calling attemptFetch again in ${u} millis`),Wa(n,d,i,s)}}function Hh(n,e){return new Promise((t,i)=>{const s=Math.max(e-Date.now(),0),r=setTimeout(t,s);n.addEventListener(()=>{clearTimeout(r),i(ne.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function jh(n){if(!(n instanceof _e)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class zh{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function $h(n,e,t,i,s){if(s&&s.global){n("event",t,i);return}else{const r=await e,o=Object.assign(Object.assign({},i),{send_to:r});n("event",t,o)}}async function Vh(){if(da())try{await ha()}catch(n){return Z.warn(ne.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return Z.warn(ne.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function qh(n,e,t,i,s,r,o){var a;const l=Wh(n);l.then(m=>{t[m.measurementId]=m.appId,n.options.measurementId&&m.measurementId!==n.options.measurementId&&Z.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>Z.error(m)),e.push(l);const c=Vh().then(m=>{if(m)return i.getId()}),[u,d]=await Promise.all([l,c]);Ph(r)||kh(r,u.measurementId),s("js",new Date);const h=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return h[Ch]="firebase",h.update=!0,d!=null&&(h[Eh]=d),s("config",u.measurementId,h),u.measurementId}class Gh{constructor(e){this.app=e}_delete(){return delete Lt[this.app.options.appId],Promise.resolve()}}let Lt={},zr=[];const $r={};let Fi="dataLayer",Kh="gtag",Vr,Ha,qr=!1;function Yh(){const n=[];if(la()&&n.push("This is a browser extension environment."),_u()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,s)=>`(${s+1}) ${i}`).join(" "),t=ne.create("invalid-analytics-context",{errorInfo:e});Z.warn(t.message)}}function Jh(n,e,t){Yh();const i=n.options.appId;if(!i)throw ne.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Z.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ne.create("no-api-key");if(Lt[i]!=null)throw ne.create("already-exists",{id:i});if(!qr){Rh(Fi);const{wrappedGtag:r,gtagCore:o}=Oh(Lt,zr,$r,Fi,Kh);Ha=r,Vr=o,qr=!0}return Lt[i]=qh(n,zr,$r,e,Vr,Fi,t),new Gh(n)}function ja(n=xs()){n=K(n);const e=ot(n,Fn);return e.isInitialized()?e.getImmediate():Qh(n)}function Qh(n,e={}){const t=ot(n,Fn);if(t.isInitialized()){const s=t.getImmediate();if(zt(e,t.getOptions()))return s;throw ne.create("already-initialized")}return t.initialize({options:e})}function Xh(n,e,t,i){n=K(n),$h(Ha,Lt[n.app.options.appId],e,t,i).catch(s=>Z.error(s))}const Gr="@firebase/analytics",Kr="0.9.3";function Zh(){me(new ce(Fn,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return Jh(i,s,t)},"PUBLIC")),me(new ce("analytics-internal",n,"PRIVATE")),te(Gr,Kr),te(Gr,Kr,"esm2017");function n(e){try{const t=e.getProvider(Fn).getImmediate();return{logEvent:(i,s,r)=>Xh(t,i,s,r)}}catch(t){throw ne.create("interop-component-reg-failed",{reason:t})}}}Zh();var Ui=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ee={exports:{}};(function(n){(function(e,t){n.exports=t(e)})(typeof Ui<"u"?Ui:typeof window<"u"?window:Ui,function(e){if(typeof e>"u"&&typeof e.document>"u")return!1;var t="Notiflix",i=`

Visit documentation page to learn more: https://notiflix.github.io/documentation`,s='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif',r={Success:"Success",Failure:"Failure",Warning:"Warning",Info:"Info"},o,a={wrapID:"NotiflixNotifyWrap",overlayID:"NotiflixNotifyOverlay",width:"280px",position:"right-top",distance:"10px",opacity:1,borderRadius:"5px",rtl:!1,timeout:3e3,messageMaxLength:110,backOverlay:!1,backOverlayColor:"rgba(0,0,0,0.5)",plainText:!0,showOnlyTheLastOne:!1,clickToClose:!1,pauseOnHover:!0,ID:"NotiflixNotify",className:"notiflix-notify",zindex:4001,fontFamily:"Quicksand",fontSize:"13px",cssAnimation:!0,cssAnimationDuration:400,cssAnimationStyle:"fade",closeButton:!1,useIcon:!0,useFontAwesome:!1,fontAwesomeIconStyle:"basic",fontAwesomeIconSize:"34px",success:{background:"#32c682",textColor:"#fff",childClassName:"notiflix-notify-success",notiflixIconColor:"rgba(0,0,0,0.2)",fontAwesomeClassName:"fas fa-check-circle",fontAwesomeIconColor:"rgba(0,0,0,0.2)",backOverlayColor:"rgba(50,198,130,0.2)"},failure:{background:"#ff5549",textColor:"#fff",childClassName:"notiflix-notify-failure",notiflixIconColor:"rgba(0,0,0,0.2)",fontAwesomeClassName:"fas fa-times-circle",fontAwesomeIconColor:"rgba(0,0,0,0.2)",backOverlayColor:"rgba(255,85,73,0.2)"},warning:{background:"#eebf31",textColor:"#fff",childClassName:"notiflix-notify-warning",notiflixIconColor:"rgba(0,0,0,0.2)",fontAwesomeClassName:"fas fa-exclamation-circle",fontAwesomeIconColor:"rgba(0,0,0,0.2)",backOverlayColor:"rgba(238,191,49,0.2)"},info:{background:"#26c0d3",textColor:"#fff",childClassName:"notiflix-notify-info",notiflixIconColor:"rgba(0,0,0,0.2)",fontAwesomeClassName:"fas fa-info-circle",fontAwesomeIconColor:"rgba(0,0,0,0.2)",backOverlayColor:"rgba(38,192,211,0.2)"}},l=function(y){return console.error("%c "+t+" Error ","padding:2px;border-radius:20px;color:#fff;background:#ff5549",`
`+y+i)},c=function(y){return y||(y="head"),e.document[y]===null?(l(`
Notiflix needs to be appended to the "<`+y+'>" element, but you called it before the "<'+y+'>" element has been created.'),!1):!0},u=function(y,I){if(!c("head"))return!1;if(y()!==null&&!e.document.getElementById(I)){var E=e.document.createElement("style");E.id=I,E.innerHTML=y(),e.document.head.appendChild(E)}},d=function(){var y={},I=!1,E=0;Object.prototype.toString.call(arguments[0])==="[object Boolean]"&&(I=arguments[0],E++);for(var X=function(de){for(var q in de)Object.prototype.hasOwnProperty.call(de,q)&&(I&&Object.prototype.toString.call(de[q])==="[object Object]"?y[q]=d(y[q],de[q]):y[q]=de[q])};E<arguments.length;E++)X(arguments[E]);return y},h=function(y){var I=e.document.createElement("div");return I.innerHTML=y,I.textContent||I.innerText||""},m=function(){var y='[id^=NotiflixNotifyWrap]{pointer-events:none;position:fixed;z-index:4001;opacity:1;right:10px;top:10px;width:280px;max-width:96%;-webkit-box-sizing:border-box;box-sizing:border-box;background:transparent}[id^=NotiflixNotifyWrap].nx-flex-center-center{max-height:calc(100vh - 20px);overflow-x:hidden;overflow-y:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;margin:auto}[id^=NotiflixNotifyWrap]::-webkit-scrollbar{width:0;height:0}[id^=NotiflixNotifyWrap]::-webkit-scrollbar-thumb{background:transparent}[id^=NotiflixNotifyWrap]::-webkit-scrollbar-track{background:transparent}[id^=NotiflixNotifyWrap] *{-webkit-box-sizing:border-box;box-sizing:border-box}[id^=NotiflixNotifyOverlay]{-webkit-transition:background .3s ease-in-out;-o-transition:background .3s ease-in-out;transition:background .3s ease-in-out}[id^=NotiflixNotifyWrap]>div{pointer-events:all;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-family:"Quicksand",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;width:100%;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;position:relative;margin:0 0 10px;border-radius:5px;background:#1e1e1e;color:#fff;padding:10px 12px;font-size:14px;line-height:1.4}[id^=NotiflixNotifyWrap]>div:last-child{margin:0}[id^=NotiflixNotifyWrap]>div.nx-with-callback{cursor:pointer}[id^=NotiflixNotifyWrap]>div.nx-with-icon{padding:8px;min-height:56px}[id^=NotiflixNotifyWrap]>div.nx-paused{cursor:auto}[id^=NotiflixNotifyWrap]>div.nx-notify-click-to-close{cursor:pointer}[id^=NotiflixNotifyWrap]>div.nx-with-close-button{padding:10px 36px 10px 12px}[id^=NotiflixNotifyWrap]>div.nx-with-icon.nx-with-close-button{padding:6px 36px 6px 6px}[id^=NotiflixNotifyWrap]>div>span.nx-message{cursor:inherit;font-weight:normal;font-family:inherit!important;word-break:break-all;word-break:break-word}[id^=NotiflixNotifyWrap]>div>span.nx-close-button{cursor:pointer;-webkit-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out;transition:all .2s ease-in-out;position:absolute;right:8px;top:0;bottom:0;margin:auto;color:inherit;width:20px;height:20px}[id^=NotiflixNotifyWrap]>div>span.nx-close-button:hover{-webkit-transform:rotate(90deg);transform:rotate(90deg)}[id^=NotiflixNotifyWrap]>div>span.nx-close-button>svg{position:absolute;width:16px;height:16px;right:2px;top:2px}[id^=NotiflixNotifyWrap]>div>.nx-message-icon{position:absolute;width:40px;height:40px;font-size:30px;line-height:40px;text-align:center;left:8px;top:0;bottom:0;margin:auto;border-radius:inherit}[id^=NotiflixNotifyWrap]>div>.nx-message-icon-fa.nx-message-icon-fa-shadow{color:inherit;background:rgba(0,0,0,.15);-webkit-box-shadow:inset 0 0 34px rgba(0,0,0,.2);box-shadow:inset 0 0 34px rgba(0,0,0,.2);text-shadow:0 0 10px rgba(0,0,0,.3)}[id^=NotiflixNotifyWrap]>div>span.nx-with-icon{position:relative;float:left;width:calc(100% - 40px);margin:0 0 0 40px;padding:0 0 0 10px;-webkit-box-sizing:border-box;box-sizing:border-box}[id^=NotiflixNotifyWrap]>div.nx-rtl-on>.nx-message-icon{left:auto;right:8px}[id^=NotiflixNotifyWrap]>div.nx-rtl-on>span.nx-with-icon{padding:0 10px 0 0;margin:0 40px 0 0}[id^=NotiflixNotifyWrap]>div.nx-rtl-on>span.nx-close-button{right:auto;left:8px}[id^=NotiflixNotifyWrap]>div.nx-with-icon.nx-with-close-button.nx-rtl-on{padding:6px 6px 6px 36px}[id^=NotiflixNotifyWrap]>div.nx-with-close-button.nx-rtl-on{padding:10px 12px 10px 36px}[id^=NotiflixNotifyOverlay].nx-with-animation,[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-fade{-webkit-animation:notify-animation-fade .3s ease-in-out 0s normal;animation:notify-animation-fade .3s ease-in-out 0s normal}@-webkit-keyframes notify-animation-fade{0%{opacity:0}100%{opacity:1}}@keyframes notify-animation-fade{0%{opacity:0}100%{opacity:1}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-zoom{-webkit-animation:notify-animation-zoom .3s ease-in-out 0s normal;animation:notify-animation-zoom .3s ease-in-out 0s normal}@-webkit-keyframes notify-animation-zoom{0%{-webkit-transform:scale(0);transform:scale(0)}50%{-webkit-transform:scale(1.05);transform:scale(1.05)}100%{-webkit-transform:scale(1);transform:scale(1)}}@keyframes notify-animation-zoom{0%{-webkit-transform:scale(0);transform:scale(0)}50%{-webkit-transform:scale(1.05);transform:scale(1.05)}100%{-webkit-transform:scale(1);transform:scale(1)}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-right{-webkit-animation:notify-animation-from-right .3s ease-in-out 0s normal;animation:notify-animation-from-right .3s ease-in-out 0s normal}@-webkit-keyframes notify-animation-from-right{0%{right:-300px;opacity:0}50%{right:8px;opacity:1}100%{right:0;opacity:1}}@keyframes notify-animation-from-right{0%{right:-300px;opacity:0}50%{right:8px;opacity:1}100%{right:0;opacity:1}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-left{-webkit-animation:notify-animation-from-left .3s ease-in-out 0s normal;animation:notify-animation-from-left .3s ease-in-out 0s normal}@-webkit-keyframes notify-animation-from-left{0%{left:-300px;opacity:0}50%{left:8px;opacity:1}100%{left:0;opacity:1}}@keyframes notify-animation-from-left{0%{left:-300px;opacity:0}50%{left:8px;opacity:1}100%{left:0;opacity:1}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-top{-webkit-animation:notify-animation-from-top .3s ease-in-out 0s normal;animation:notify-animation-from-top .3s ease-in-out 0s normal}@-webkit-keyframes notify-animation-from-top{0%{top:-50px;opacity:0}50%{top:8px;opacity:1}100%{top:0;opacity:1}}@keyframes notify-animation-from-top{0%{top:-50px;opacity:0}50%{top:8px;opacity:1}100%{top:0;opacity:1}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-bottom{-webkit-animation:notify-animation-from-bottom .3s ease-in-out 0s normal;animation:notify-animation-from-bottom .3s ease-in-out 0s normal}@-webkit-keyframes notify-animation-from-bottom{0%{bottom:-50px;opacity:0}50%{bottom:8px;opacity:1}100%{bottom:0;opacity:1}}@keyframes notify-animation-from-bottom{0%{bottom:-50px;opacity:0}50%{bottom:8px;opacity:1}100%{bottom:0;opacity:1}}[id^=NotiflixNotifyOverlay].nx-with-animation.nx-remove,[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-fade.nx-remove{opacity:0;-webkit-animation:notify-remove-fade .3s ease-in-out 0s normal;animation:notify-remove-fade .3s ease-in-out 0s normal}@-webkit-keyframes notify-remove-fade{0%{opacity:1}100%{opacity:0}}@keyframes notify-remove-fade{0%{opacity:1}100%{opacity:0}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-zoom.nx-remove{-webkit-transform:scale(0);transform:scale(0);-webkit-animation:notify-remove-zoom .3s ease-in-out 0s normal;animation:notify-remove-zoom .3s ease-in-out 0s normal}@-webkit-keyframes notify-remove-zoom{0%{-webkit-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.05);transform:scale(1.05)}100%{-webkit-transform:scale(0);transform:scale(0)}}@keyframes notify-remove-zoom{0%{-webkit-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.05);transform:scale(1.05)}100%{-webkit-transform:scale(0);transform:scale(0)}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-top.nx-remove{opacity:0;-webkit-animation:notify-remove-to-top .3s ease-in-out 0s normal;animation:notify-remove-to-top .3s ease-in-out 0s normal}@-webkit-keyframes notify-remove-to-top{0%{top:0;opacity:1}50%{top:8px;opacity:1}100%{top:-50px;opacity:0}}@keyframes notify-remove-to-top{0%{top:0;opacity:1}50%{top:8px;opacity:1}100%{top:-50px;opacity:0}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-right.nx-remove{opacity:0;-webkit-animation:notify-remove-to-right .3s ease-in-out 0s normal;animation:notify-remove-to-right .3s ease-in-out 0s normal}@-webkit-keyframes notify-remove-to-right{0%{right:0;opacity:1}50%{right:8px;opacity:1}100%{right:-300px;opacity:0}}@keyframes notify-remove-to-right{0%{right:0;opacity:1}50%{right:8px;opacity:1}100%{right:-300px;opacity:0}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-bottom.nx-remove{opacity:0;-webkit-animation:notify-remove-to-bottom .3s ease-in-out 0s normal;animation:notify-remove-to-bottom .3s ease-in-out 0s normal}@-webkit-keyframes notify-remove-to-bottom{0%{bottom:0;opacity:1}50%{bottom:8px;opacity:1}100%{bottom:-50px;opacity:0}}@keyframes notify-remove-to-bottom{0%{bottom:0;opacity:1}50%{bottom:8px;opacity:1}100%{bottom:-50px;opacity:0}}[id^=NotiflixNotifyWrap]>div.nx-with-animation.nx-from-left.nx-remove{opacity:0;-webkit-animation:notify-remove-to-left .3s ease-in-out 0s normal;animation:notify-remove-to-left .3s ease-in-out 0s normal}@-webkit-keyframes notify-remove-to-left{0%{left:0;opacity:1}50%{left:8px;opacity:1}100%{left:-300px;opacity:0}}@keyframes notify-remove-to-left{0%{left:0;opacity:1}50%{left:8px;opacity:1}100%{left:-300px;opacity:0}}';return y||null},p=0,_=function(y,I,E,X){if(!c("body"))return!1;o||k.Notify.init({});var de=d(!0,o,{});if(typeof E=="object"&&!Array.isArray(E)||typeof X=="object"&&!Array.isArray(X)){var q={};typeof E=="object"?q=E:typeof X=="object"&&(q=X),o=d(!0,o,q)}var z=o[y.toLocaleLowerCase("en")];p++,typeof I!="string"&&(I="Notiflix "+y),o.plainText&&(I=h(I)),!o.plainText&&I.length>o.messageMaxLength&&(o=d(!0,o,{closeButton:!0,messageMaxLength:150}),I='Possible HTML Tags Error: The "plainText" option is "false" and the notification content length is more than the "messageMaxLength" option.'),I.length>o.messageMaxLength&&(I=I.substring(0,o.messageMaxLength)+"..."),o.fontAwesomeIconStyle==="shadow"&&(z.fontAwesomeIconColor=z.background),o.cssAnimation||(o.cssAnimationDuration=0);var v=e.document.getElementById(a.wrapID)||e.document.createElement("div");if(v.id=a.wrapID,v.style.width=o.width,v.style.zIndex=o.zindex,v.style.opacity=o.opacity,o.position==="center-center"?(v.style.left=o.distance,v.style.top=o.distance,v.style.right=o.distance,v.style.bottom=o.distance,v.style.margin="auto",v.classList.add("nx-flex-center-center"),v.style.maxHeight="calc((100vh - "+o.distance+") - "+o.distance+")",v.style.display="flex",v.style.flexWrap="wrap",v.style.flexDirection="column",v.style.justifyContent="center",v.style.alignItems="center",v.style.pointerEvents="none"):o.position==="center-top"?(v.style.left=o.distance,v.style.right=o.distance,v.style.top=o.distance,v.style.bottom="auto",v.style.margin="auto"):o.position==="center-bottom"?(v.style.left=o.distance,v.style.right=o.distance,v.style.bottom=o.distance,v.style.top="auto",v.style.margin="auto"):o.position==="right-bottom"?(v.style.right=o.distance,v.style.bottom=o.distance,v.style.top="auto",v.style.left="auto"):o.position==="left-top"?(v.style.left=o.distance,v.style.top=o.distance,v.style.right="auto",v.style.bottom="auto"):o.position==="left-bottom"?(v.style.left=o.distance,v.style.bottom=o.distance,v.style.top="auto",v.style.right="auto"):(v.style.right=o.distance,v.style.top=o.distance,v.style.left="auto",v.style.bottom="auto"),o.backOverlay){var j=e.document.getElementById(a.overlayID)||e.document.createElement("div");j.id=a.overlayID,j.style.width="100%",j.style.height="100%",j.style.position="fixed",j.style.zIndex=o.zindex-1,j.style.left=0,j.style.top=0,j.style.right=0,j.style.bottom=0,j.style.background=z.backOverlayColor||o.backOverlayColor,j.className=o.cssAnimation?"nx-with-animation":"",j.style.animationDuration=o.cssAnimation?o.cssAnimationDuration+"ms":"",e.document.getElementById(a.overlayID)||e.document.body.appendChild(j)}e.document.getElementById(a.wrapID)||e.document.body.appendChild(v);var M=e.document.createElement("div");M.id=o.ID+"-"+p,M.className=o.className+" "+z.childClassName+" "+(o.cssAnimation?"nx-with-animation":"")+" "+(o.useIcon?"nx-with-icon":"")+" nx-"+o.cssAnimationStyle+" "+(o.closeButton&&typeof E!="function"?"nx-with-close-button":"")+" "+(typeof E=="function"?"nx-with-callback":"")+" "+(o.clickToClose?"nx-notify-click-to-close":""),M.style.fontSize=o.fontSize,M.style.color=z.textColor,M.style.background=z.background,M.style.borderRadius=o.borderRadius,M.style.pointerEvents="all",o.rtl&&(M.setAttribute("dir","rtl"),M.classList.add("nx-rtl-on")),M.style.fontFamily='"'+o.fontFamily+'", '+s,o.cssAnimation&&(M.style.animationDuration=o.cssAnimationDuration+"ms");var wn="";if(o.closeButton&&typeof E!="function"&&(wn='<span class="nx-close-button"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><g><path fill="'+z.notiflixIconColor+'" d="M0.38 2.19l7.8 7.81 -7.8 7.81c-0.51,0.5 -0.51,1.31 -0.01,1.81 0.25,0.25 0.57,0.38 0.91,0.38 0.34,0 0.67,-0.14 0.91,-0.38l7.81 -7.81 7.81 7.81c0.24,0.24 0.57,0.38 0.91,0.38 0.34,0 0.66,-0.14 0.9,-0.38 0.51,-0.5 0.51,-1.31 0,-1.81l-7.81 -7.81 7.81 -7.81c0.51,-0.5 0.51,-1.31 0,-1.82 -0.5,-0.5 -1.31,-0.5 -1.81,0l-7.81 7.81 -7.81 -7.81c-0.5,-0.5 -1.31,-0.5 -1.81,0 -0.51,0.51 -0.51,1.32 0,1.82z"/></g></svg></span>'),o.useIcon)if(o.useFontAwesome)M.innerHTML='<i style="color:'+z.fontAwesomeIconColor+"; font-size:"+o.fontAwesomeIconSize+';" class="nx-message-icon nx-message-icon-fa '+z.fontAwesomeClassName+" "+(o.fontAwesomeIconStyle==="shadow"?"nx-message-icon-fa-shadow":"nx-message-icon-fa-basic")+'"></i><span class="nx-message nx-with-icon">'+I+"</span>"+(o.closeButton?wn:"");else{var Rt="";y===r.Success?Rt='<svg class="nx-message-icon" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40"><g><path fill="'+z.notiflixIconColor+'" d="M20 0c11.03,0 20,8.97 20,20 0,11.03 -8.97,20 -20,20 -11.03,0 -20,-8.97 -20,-20 0,-11.03 8.97,-20 20,-20zm0 37.98c9.92,0 17.98,-8.06 17.98,-17.98 0,-9.92 -8.06,-17.98 -17.98,-17.98 -9.92,0 -17.98,8.06 -17.98,17.98 0,9.92 8.06,17.98 17.98,17.98zm-2.4 -13.29l11.52 -12.96c0.37,-0.41 1.01,-0.45 1.42,-0.08 0.42,0.37 0.46,1 0.09,1.42l-12.16 13.67c-0.19,0.22 -0.46,0.34 -0.75,0.34 -0.23,0 -0.45,-0.07 -0.63,-0.22l-7.6 -6.07c-0.43,-0.35 -0.5,-0.99 -0.16,-1.42 0.35,-0.43 0.99,-0.5 1.42,-0.16l6.85 5.48z"/></g></svg>':y===r.Failure?Rt='<svg class="nx-message-icon" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40"><g><path fill="'+z.notiflixIconColor+'" d="M20 0c11.03,0 20,8.97 20,20 0,11.03 -8.97,20 -20,20 -11.03,0 -20,-8.97 -20,-20 0,-11.03 8.97,-20 20,-20zm0 37.98c9.92,0 17.98,-8.06 17.98,-17.98 0,-9.92 -8.06,-17.98 -17.98,-17.98 -9.92,0 -17.98,8.06 -17.98,17.98 0,9.92 8.06,17.98 17.98,17.98zm1.42 -17.98l6.13 6.12c0.39,0.4 0.39,1.04 0,1.43 -0.19,0.19 -0.45,0.29 -0.71,0.29 -0.27,0 -0.53,-0.1 -0.72,-0.29l-6.12 -6.13 -6.13 6.13c-0.19,0.19 -0.44,0.29 -0.71,0.29 -0.27,0 -0.52,-0.1 -0.71,-0.29 -0.39,-0.39 -0.39,-1.03 0,-1.43l6.13 -6.12 -6.13 -6.13c-0.39,-0.39 -0.39,-1.03 0,-1.42 0.39,-0.39 1.03,-0.39 1.42,0l6.13 6.12 6.12 -6.12c0.4,-0.39 1.04,-0.39 1.43,0 0.39,0.39 0.39,1.03 0,1.42l-6.13 6.13z"/></g></svg>':y===r.Warning?Rt='<svg class="nx-message-icon" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40"><g><path fill="'+z.notiflixIconColor+'" d="M21.91 3.48l17.8 30.89c0.84,1.46 -0.23,3.25 -1.91,3.25l-35.6 0c-1.68,0 -2.75,-1.79 -1.91,-3.25l17.8 -30.89c0.85,-1.47 2.97,-1.47 3.82,0zm16.15 31.84l-17.8 -30.89c-0.11,-0.2 -0.41,-0.2 -0.52,0l-17.8 30.89c-0.12,0.2 0.05,0.4 0.26,0.4l35.6 0c0.21,0 0.38,-0.2 0.26,-0.4zm-19.01 -4.12l0 -1.05c0,-0.53 0.42,-0.95 0.95,-0.95 0.53,0 0.95,0.42 0.95,0.95l0 1.05c0,0.53 -0.42,0.95 -0.95,0.95 -0.53,0 -0.95,-0.42 -0.95,-0.95zm0 -4.66l0 -13.39c0,-0.52 0.42,-0.95 0.95,-0.95 0.53,0 0.95,0.43 0.95,0.95l0 13.39c0,0.53 -0.42,0.96 -0.95,0.96 -0.53,0 -0.95,-0.43 -0.95,-0.96z"/></g></svg>':y===r.Info&&(Rt='<svg class="nx-message-icon" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40"><g><path fill="'+z.notiflixIconColor+'" d="M20 0c11.03,0 20,8.97 20,20 0,11.03 -8.97,20 -20,20 -11.03,0 -20,-8.97 -20,-20 0,-11.03 8.97,-20 20,-20zm0 37.98c9.92,0 17.98,-8.06 17.98,-17.98 0,-9.92 -8.06,-17.98 -17.98,-17.98 -9.92,0 -17.98,8.06 -17.98,17.98 0,9.92 8.06,17.98 17.98,17.98zm-0.99 -23.3c0,-0.54 0.44,-0.98 0.99,-0.98 0.55,0 0.99,0.44 0.99,0.98l0 15.86c0,0.55 -0.44,0.99 -0.99,0.99 -0.55,0 -0.99,-0.44 -0.99,-0.99l0 -15.86zm0 -5.22c0,-0.55 0.44,-0.99 0.99,-0.99 0.55,0 0.99,0.44 0.99,0.99l0 1.09c0,0.54 -0.44,0.99 -0.99,0.99 -0.55,0 -0.99,-0.45 -0.99,-0.99l0 -1.09z"/></g></svg>'),M.innerHTML=Rt+'<span class="nx-message nx-with-icon">'+I+"</span>"+(o.closeButton?wn:"")}else M.innerHTML='<span class="nx-message">'+I+"</span>"+(o.closeButton?wn:"");if(o.position==="left-bottom"||o.position==="right-bottom"){var Nr=e.document.getElementById(a.wrapID);Nr.insertBefore(M,Nr.firstChild)}else e.document.getElementById(a.wrapID).appendChild(M);var ie=e.document.getElementById(M.id);if(ie){var Ci,Ti,Si=function(){ie.classList.add("nx-remove");var se=e.document.getElementById(a.overlayID);se&&v.childElementCount<=0&&se.classList.add("nx-remove"),clearTimeout(Ci)},ki=function(){if(ie&&ie.parentNode!==null&&ie.parentNode.removeChild(ie),v.childElementCount<=0&&v.parentNode!==null){v.parentNode.removeChild(v);var se=e.document.getElementById(a.overlayID);se&&se.parentNode!==null&&se.parentNode.removeChild(se)}clearTimeout(Ti)};if(o.closeButton&&typeof E!="function"){var ru=e.document.getElementById(M.id).querySelector("span.nx-close-button");ru.addEventListener("click",function(){Si();var se=setTimeout(function(){ki(),clearTimeout(se)},o.cssAnimationDuration)})}if((typeof E=="function"||o.clickToClose)&&ie.addEventListener("click",function(){typeof E=="function"&&E(),Si();var se=setTimeout(function(){ki(),clearTimeout(se)},o.cssAnimationDuration)}),!o.closeButton&&typeof E!="function"){var Ar=function(){Ci=setTimeout(function(){Si()},o.timeout),Ti=setTimeout(function(){ki()},o.timeout+o.cssAnimationDuration)};Ar(),o.pauseOnHover&&(ie.addEventListener("mouseenter",function(){ie.classList.add("nx-paused"),clearTimeout(Ci),clearTimeout(Ti)}),ie.addEventListener("mouseleave",function(){ie.classList.remove("nx-paused"),Ar()}))}}if(o.showOnlyTheLastOne&&p>0)for(var xr=e.document.querySelectorAll("[id^="+o.ID+"-]:not([id="+o.ID+"-"+p+"])"),Ri=0;Ri<xr.length;Ri++){var Ni=xr[Ri];Ni.parentNode!==null&&Ni.parentNode.removeChild(Ni)}o=d(!0,o,de)},k={Notify:{init:function(y){o=d(!0,a,y),u(m,"NotiflixNotifyInternalCSS")},merge:function(y){if(o)o=d(!0,o,y);else return l("You have to initialize the Notify module before call Merge function."),!1},success:function(y,I,E){_(r.Success,y,I,E)},failure:function(y,I,E){_(r.Failure,y,I,E)},warning:function(y,I,E){_(r.Warning,y,I,E)},info:function(y,I,E){_(r.Info,y,I,E)}}};return typeof e.Notiflix=="object"?d(!0,e.Notiflix,{Notify:k.Notify}):{Notify:k.Notify}})})(ee);function Ls(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t}function za(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ef=za,$a=new rt("auth","Firebase",za());const Yr=new ri("@firebase/auth");function Cn(n,...e){Yr.logLevel<=A.ERROR&&Yr.error(`Auth (${sn}): ${n}`,...e)}function ue(n,...e){throw Fs(n,...e)}function fe(n,...e){return Fs(n,...e)}function tf(n,e,t){const i=Object.assign(Object.assign({},ef()),{[e]:t});return new rt("auth","Firebase",i).create(e,{appName:n.name})}function Fs(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return $a.create(n,...e)}function b(n,e,...t){if(!n)throw Fs(e,...t)}function ye(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Cn(e),new Error(e)}function Ee(n,e){n||ye(e)}const Jr=new Map;function ve(n){Ee(n instanceof Function,"Expected a class definition");let e=Jr.get(n);return e?(Ee(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Jr.set(n,e),e)}function nf(n,e){const t=ot(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),r=t.getOptions();if(zt(r,e??{}))return s;ue(s,"already-initialized")}return t.initialize({options:e})}function sf(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(ve);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function as(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function rf(){return Qr()==="http:"||Qr()==="https:"}function Qr(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function of(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(rf()||la()||"connection"in navigator)?navigator.onLine:!0}function af(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class rn{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ee(t>e,"Short delay should be less than long delay!"),this.isMobile=ks()||ca()}get(){return of()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Us(n,e){Ee(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Va{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;ye("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;ye("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;ye("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const lf={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"};const cf=new rn(3e4,6e4);function on(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function an(n,e,t,i,s={}){return qa(n,s,async()=>{let r={},o={};i&&(e==="GET"?o=i:r={body:JSON.stringify(i)});const a=It(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();return l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode),Va.fetch()(Ga(n,n.config.apiHost,t,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},r))})}async function qa(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},lf),e);try{const s=new uf(n),r=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw bn(n,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const a=r.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw bn(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw bn(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw bn(n,"user-disabled",o);const u=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw tf(n,u,c);ue(n,u)}}catch(s){if(s instanceof _e)throw s;ue(n,"network-request-failed")}}async function ln(n,e,t,i,s={}){const r=await an(n,e,t,i,s);return"mfaPendingCredential"in r&&ue(n,"multi-factor-auth-required",{_serverResponse:r}),r}function Ga(n,e,t,i){const s=`${e}${t}?${i}`;return n.config.emulator?Us(n.config,s):`${n.config.apiScheme}://${s}`}class uf{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(fe(this.auth,"network-request-failed")),cf.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function bn(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const s=fe(n,e,i);return s.customData._tokenResponse=t,s}async function df(n,e){return an(n,"POST","/v1/accounts:delete",e)}async function hf(n,e){return an(n,"POST","/v1/accounts:lookup",e)}function Ft(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function ff(n,e=!1){const t=K(n),i=await t.getIdToken(e),s=Bs(i);b(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const r=typeof s.firebase=="object"?s.firebase:void 0,o=r==null?void 0:r.sign_in_provider;return{claims:s,token:i,authTime:Ft(Bi(s.auth_time)),issuedAtTime:Ft(Bi(s.iat)),expirationTime:Ft(Bi(s.exp)),signInProvider:o||null,signInSecondFactor:(r==null?void 0:r.sign_in_second_factor)||null}}function Bi(n){return Number(n)*1e3}function Bs(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Cn("JWT malformed, contained fewer than 3 sections"),null;try{const s=Pn(t);return s?JSON.parse(s):(Cn("Failed to decode base64 JWT payload"),null)}catch(s){return Cn("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function pf(n){const e=Bs(n);return b(e,"internal-error"),b(typeof e.exp<"u","internal-error"),b(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Vt(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof _e&&mf(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function mf({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class gf{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ka{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ft(this.lastLoginAt),this.creationTime=Ft(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Un(n){var e;const t=n.auth,i=await n.getIdToken(),s=await Vt(n,hf(t,{idToken:i}));b(s==null?void 0:s.users.length,t,"internal-error");const r=s.users[0];n._notifyReloadListener(r);const o=!((e=r.providerUserInfo)===null||e===void 0)&&e.length?vf(r.providerUserInfo):[],a=yf(n.providerData,o),l=n.isAnonymous,c=!(n.email&&r.passwordHash)&&!(a!=null&&a.length),u=l?c:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new Ka(r.createdAt,r.lastLoginAt),isAnonymous:u};Object.assign(n,d)}async function _f(n){const e=K(n);await Un(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function yf(n,e){return[...n.filter(i=>!e.some(s=>s.providerId===i.providerId)),...e]}function vf(n){return n.map(e=>{var{providerId:t}=e,i=Ls(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}async function wf(n,e){const t=await qa(n,{},async()=>{const i=It({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:r}=n.config,o=Ga(n,s,"/v1/token",`key=${r}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Va.fetch()(o,{method:"POST",headers:a,body:i})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}class qt{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){b(e.idToken,"internal-error"),b(typeof e.idToken<"u","internal-error"),b(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):pf(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return b(!this.accessToken||this.refreshToken,e,"user-token-expired"),!t&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:s,expiresIn:r}=await wf(e,t);this.updateTokensAndExpiration(i,s,Number(r))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:s,expirationTime:r}=t,o=new qt;return i&&(b(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),s&&(b(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),r&&(b(typeof r=="number","internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new qt,this.toJSON())}_performRefresh(){return ye("not implemented")}}function Re(n,e){b(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ke{constructor(e){var{uid:t,auth:i,stsTokenManager:s}=e,r=Ls(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new gf(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Ka(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Vt(this,this.stsTokenManager.getToken(this.auth,e));return b(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return ff(this,e)}reload(){return _f(this)}_assign(e){this!==e&&(b(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new Ke(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){b(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Un(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Vt(this,df(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,s,r,o,a,l,c,u;const d=(i=t.displayName)!==null&&i!==void 0?i:void 0,h=(s=t.email)!==null&&s!==void 0?s:void 0,m=(r=t.phoneNumber)!==null&&r!==void 0?r:void 0,p=(o=t.photoURL)!==null&&o!==void 0?o:void 0,_=(a=t.tenantId)!==null&&a!==void 0?a:void 0,k=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,y=(c=t.createdAt)!==null&&c!==void 0?c:void 0,I=(u=t.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:E,emailVerified:X,isAnonymous:de,providerData:q,stsTokenManager:z}=t;b(E&&z,e,"internal-error");const v=qt.fromJSON(this.name,z);b(typeof E=="string",e,"internal-error"),Re(d,e.name),Re(h,e.name),b(typeof X=="boolean",e,"internal-error"),b(typeof de=="boolean",e,"internal-error"),Re(m,e.name),Re(p,e.name),Re(_,e.name),Re(k,e.name),Re(y,e.name),Re(I,e.name);const j=new Ke({uid:E,auth:e,email:h,emailVerified:X,displayName:d,isAnonymous:de,photoURL:p,phoneNumber:m,tenantId:_,stsTokenManager:v,createdAt:y,lastLoginAt:I});return q&&Array.isArray(q)&&(j.providerData=q.map(M=>Object.assign({},M))),k&&(j._redirectEventId=k),j}static async _fromIdTokenResponse(e,t,i=!1){const s=new qt;s.updateFromServerResponse(t);const r=new Ke({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:i});return await Un(r),r}}class Ya{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ya.type="NONE";const Xr=Ya;function Tn(n,e,t){return`firebase:${n}:${e}:${t}`}class dt{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:s,name:r}=this.auth;this.fullUserKey=Tn(this.userKey,s.apiKey,r),this.fullPersistenceKey=Tn("persistence",s.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ke._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new dt(ve(Xr),e,i);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let r=s[0]||ve(Xr);const o=Tn(i,e.config.apiKey,e.name);let a=null;for(const c of t)try{const u=await c._get(o);if(u){const d=Ke._fromJSON(e,u);c!==r&&(a=d),r=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!r._shouldAllowMigration||!l.length?new dt(r,e,i):(r=l[0],a&&await r._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==r)try{await c._remove(o)}catch{}})),new dt(r,e,i))}}function Zr(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Xa(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ja(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(el(e))return"Blackberry";if(tl(e))return"Webos";if(Ws(e))return"Safari";if((e.includes("chrome/")||Qa(e))&&!e.includes("edge/"))return"Chrome";if(Za(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function Ja(n=V()){return/firefox\//i.test(n)}function Ws(n=V()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Qa(n=V()){return/crios\//i.test(n)}function Xa(n=V()){return/iemobile/i.test(n)}function Za(n=V()){return/android/i.test(n)}function el(n=V()){return/blackberry/i.test(n)}function tl(n=V()){return/webos/i.test(n)}function li(n=V()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function bf(n=V()){var e;return li(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function If(){return gu()&&document.documentMode===10}function nl(n=V()){return li(n)||Za(n)||tl(n)||el(n)||/windows phone/i.test(n)||Xa(n)}function Ef(){try{return!!(window&&window!==window.top)}catch{return!1}}function il(n,e=[]){let t;switch(n){case"Browser":t=Zr(V());break;case"Worker":t=`${Zr(V())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${sn}/${i}`}class Cf{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=r=>new Promise((o,a)=>{try{const l=e(r);o(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}class Tf{constructor(e,t,i){this.app=e,this.heartbeatServiceProvider=t,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new eo(this),this.idTokenSubscription=new eo(this),this.beforeStateQueue=new Cf(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$a,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ve(t)),this._initializationPromise=this.queue(async()=>{var i,s;if(!this._deleted&&(this.persistenceManager=await dt.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var t;const i=await this.assertedPersistence.getCurrentUser();let s=i,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return b(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Un(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=af()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?K(e):null;return t&&b(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&b(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(ve(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new rt("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ve(e)||this._popupRedirectResolver;b(t,this,"argument-error"),this.redirectPersistenceManager=await dt.create(this,[ve(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,s){if(this._deleted)return()=>{};const r=typeof t=="function"?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return b(o,this,"internal-error"),o.then(()=>r(this.currentUser)),typeof t=="function"?e.addObserver(t,i,s):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return b(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=il(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());return i&&(t["X-Firebase-Client"]=i),t}}function cn(n){return K(n)}class eo{constructor(e){this.auth=e,this.observer=null,this.addObserver=Cu(t=>this.observer=t)}get next(){return b(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Sf(n,e,t){const i=cn(n);b(i._canInitEmulator,i,"emulator-config-failed"),b(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),r=sl(e),{host:o,port:a}=kf(e),l=a===null?"":`:${a}`;i.config.emulator={url:`${r}//${o}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||Rf()}function sl(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function kf(n){const e=sl(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const r=s[1];return{host:r,port:to(i.substr(r.length+1))}}else{const[r,o]=i.split(":");return{host:r,port:to(o)}}}function to(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Rf(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Hs{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ye("not implemented")}_getIdTokenResponse(e){return ye("not implemented")}_linkToIdToken(e,t){return ye("not implemented")}_getReauthenticationResolver(e){return ye("not implemented")}}async function Nf(n,e){return an(n,"POST","/v1/accounts:update",e)}async function Af(n,e){return ln(n,"POST","/v1/accounts:signInWithPassword",on(n,e))}async function xf(n,e){return ln(n,"POST","/v1/accounts:signInWithEmailLink",on(n,e))}async function Of(n,e){return ln(n,"POST","/v1/accounts:signInWithEmailLink",on(n,e))}class Gt extends Hs{constructor(e,t,i,s=null){super("password",i),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Gt(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Gt(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Af(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return xf(e,{email:this._email,oobCode:this._password});default:ue(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Nf(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return Of(e,{idToken:t,email:this._email,oobCode:this._password});default:ue(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ht(n,e){return ln(n,"POST","/v1/accounts:signInWithIdp",on(n,e))}const Pf="http://localhost";class Ze extends Hs{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ze(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ue("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s}=t,r=Ls(t,["providerId","signInMethod"]);if(!i||!s)return null;const o=new Ze(i,s);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return ht(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,ht(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ht(e,t)}buildRequest(){const e={requestUri:Pf,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=It(t)}return e}}function Df(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Mf(n){const e=Dt(Mt(n)).link,t=e?Dt(Mt(e)).deep_link_id:null,i=Dt(Mt(n)).deep_link_id;return(i?Dt(Mt(i)).link:null)||i||t||e||n}class js{constructor(e){var t,i,s,r,o,a;const l=Dt(Mt(e)),c=(t=l.apiKey)!==null&&t!==void 0?t:null,u=(i=l.oobCode)!==null&&i!==void 0?i:null,d=Df((s=l.mode)!==null&&s!==void 0?s:null);b(c&&u&&d,"argument-error"),this.apiKey=c,this.operation=d,this.code=u,this.continueUrl=(r=l.continueUrl)!==null&&r!==void 0?r:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=Mf(e);try{return new js(t)}catch{return null}}}class Et{constructor(){this.providerId=Et.PROVIDER_ID}static credential(e,t){return Gt._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=js.parseLink(t);return b(i,"argument-error"),Gt._fromEmailAndCode(e,i.code,i.tenantId)}}Et.PROVIDER_ID="password";Et.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Et.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class rl{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class un extends rl{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ae extends un{constructor(){super("facebook.com")}static credential(e){return Ze._fromParams({providerId:Ae.PROVIDER_ID,signInMethod:Ae.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ae.credentialFromTaggedObject(e)}static credentialFromError(e){return Ae.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ae.credential(e.oauthAccessToken)}catch{return null}}}Ae.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ae.PROVIDER_ID="facebook.com";class xe extends un{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ze._fromParams({providerId:xe.PROVIDER_ID,signInMethod:xe.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return xe.credentialFromTaggedObject(e)}static credentialFromError(e){return xe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return xe.credential(t,i)}catch{return null}}}xe.GOOGLE_SIGN_IN_METHOD="google.com";xe.PROVIDER_ID="google.com";class Oe extends un{constructor(){super("github.com")}static credential(e){return Ze._fromParams({providerId:Oe.PROVIDER_ID,signInMethod:Oe.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Oe.credentialFromTaggedObject(e)}static credentialFromError(e){return Oe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Oe.credential(e.oauthAccessToken)}catch{return null}}}Oe.GITHUB_SIGN_IN_METHOD="github.com";Oe.PROVIDER_ID="github.com";class Pe extends un{constructor(){super("twitter.com")}static credential(e,t){return Ze._fromParams({providerId:Pe.PROVIDER_ID,signInMethod:Pe.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Pe.credentialFromTaggedObject(e)}static credentialFromError(e){return Pe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Pe.credential(t,i)}catch{return null}}}Pe.TWITTER_SIGN_IN_METHOD="twitter.com";Pe.PROVIDER_ID="twitter.com";async function Lf(n,e){return ln(n,"POST","/v1/accounts:signUp",on(n,e))}class et{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,s=!1){const r=await Ke._fromIdTokenResponse(e,i,s),o=no(i);return new et({user:r,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const s=no(i);return new et({user:e,providerId:s,_tokenResponse:i,operationType:t})}}function no(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Bn extends _e{constructor(e,t,i,s){var r;super(t.code,t.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,Bn.prototype),this.customData={appName:e.name,tenantId:(r=e.tenantId)!==null&&r!==void 0?r:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,s){return new Bn(e,t,i,s)}}function ol(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?Bn._fromErrorAndOperation(n,r,e,i):r})}async function Ff(n,e,t=!1){const i=await Vt(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return et._forOperation(n,"link",i)}async function Uf(n,e,t=!1){const{auth:i}=n,s="reauthenticate";try{const r=await Vt(n,ol(i,s,e,n),t);b(r.idToken,i,"internal-error");const o=Bs(r.idToken);b(o,i,"internal-error");const{sub:a}=o;return b(n.uid===a,i,"user-mismatch"),et._forOperation(n,s,r)}catch(r){throw(r==null?void 0:r.code)==="auth/user-not-found"&&ue(i,"user-mismatch"),r}}async function al(n,e,t=!1){const i="signIn",s=await ol(n,i,e),r=await et._fromIdTokenResponse(n,i,s);return t||await n._updateCurrentUser(r.user),r}async function Bf(n,e){return al(cn(n),e)}async function Wf(n,e,t){const i=cn(n),s=await Lf(i,{returnSecureToken:!0,email:e,password:t}),r=await et._fromIdTokenResponse(i,"signIn",s);return await i._updateCurrentUser(r.user),r}function Hf(n,e,t){return Bf(K(n),Et.credential(e,t))}function jf(n,e,t,i){return K(n).onIdTokenChanged(e,t,i)}function zf(n,e,t){return K(n).beforeAuthStateChanged(e,t)}const Wn="__sak";class ll{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Wn,"1"),this.storage.removeItem(Wn),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}function $f(){const n=V();return Ws(n)||li(n)}const Vf=1e3,qf=10;class cl extends ll{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=$f()&&Ef(),this.fallbackToPolling=nl(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),s=this.localCache[t];i!==s&&e(t,s,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const i=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(i);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(i,e.newValue):this.storage.removeItem(i);else if(this.localCache[i]===e.newValue&&!t)return}const s=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},r=this.storage.getItem(i);If()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,qf):s()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},Vf)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}cl.type="LOCAL";const Gf=cl;class ul extends ll{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ul.type="SESSION";const dl=ul;function Kf(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class ci{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const i=new ci(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:s,data:r}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,r)),l=await Kf(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ci.receivers=[];function zs(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class Yf{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let r,o;return new Promise((a,l)=>{const c=zs("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},i);o={messageChannel:s,onMessage(d){const h=d;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(u),r=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(h.data.response);break;default:clearTimeout(u),clearTimeout(r),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function pe(){return window}function Jf(n){pe().location.href=n}function hl(){return typeof pe().WorkerGlobalScope<"u"&&typeof pe().importScripts=="function"}async function Qf(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Xf(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Zf(){return hl()?self:null}const fl="firebaseLocalStorageDb",ep=1,Hn="firebaseLocalStorage",pl="fbase_key";class dn{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ui(n,e){return n.transaction([Hn],e?"readwrite":"readonly").objectStore(Hn)}function tp(){const n=indexedDB.deleteDatabase(fl);return new dn(n).toPromise()}function ls(){const n=indexedDB.open(fl,ep);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Hn,{keyPath:pl})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Hn)?e(i):(i.close(),await tp(),e(await ls()))})})}async function io(n,e,t){const i=ui(n,!0).put({[pl]:e,value:t});return new dn(i).toPromise()}async function np(n,e){const t=ui(n,!1).get(e),i=await new dn(t).toPromise();return i===void 0?null:i.value}function so(n,e){const t=ui(n,!0).delete(e);return new dn(t).toPromise()}const ip=800,sp=3;class ml{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ls(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>sp)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return hl()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ci._getInstance(Zf()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Qf(),!this.activeServiceWorker)return;this.sender=new Yf(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Xf()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ls();return await io(e,Wn,"1"),await so(e,Wn),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>io(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>np(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>so(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const r=ui(s,!1).getAll();return new dn(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;for(const{fbase_key:s,value:r}of e)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(r)&&(this.notifyListeners(s,r),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ip)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ml.type="LOCAL";const rp=ml;function op(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}function ap(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=s=>{const r=fe("internal-error");r.customData=s,t(r)},i.type="text/javascript",i.charset="UTF-8",op().appendChild(i)})}function lp(n){return`__${n}${Math.floor(Math.random()*1e6)}`}new rn(3e4,6e4);function cp(n,e){return e?ve(e):(b(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class $s extends Hs{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ht(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ht(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ht(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function up(n){return al(n.auth,new $s(n),n.bypassAuthState)}function dp(n){const{auth:e,user:t}=n;return b(t,e,"internal-error"),Uf(t,new $s(n),n.bypassAuthState)}async function hp(n){const{auth:e,user:t}=n;return b(t,e,"internal-error"),Ff(t,new $s(n),n.bypassAuthState)}class gl{constructor(e,t,i,s,r=!1){this.auth=e,this.resolver=i,this.user=s,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:s,tenantId:r,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:i,tenantId:r||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return up;case"linkViaPopup":case"linkViaRedirect":return hp;case"reauthViaPopup":case"reauthViaRedirect":return dp;default:ue(this.auth,"internal-error")}}resolve(e){Ee(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ee(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const fp=new rn(2e3,1e4);class ct extends gl{constructor(e,t,i,s,r){super(e,t,s,r),this.provider=i,this.authWindow=null,this.pollId=null,ct.currentPopupAction&&ct.currentPopupAction.cancel(),ct.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return b(e,this.auth,"internal-error"),e}async onExecution(){Ee(this.filter.length===1,"Popup operations only handle one event");const e=zs();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(fe(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(fe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ct.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(fe(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,fp.get())};e()}}ct.currentPopupAction=null;const pp="pendingRedirect",Sn=new Map;class mp extends gl{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Sn.get(this.auth._key());if(!e){try{const i=await gp(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Sn.set(this.auth._key(),e)}return this.bypassAuthState||Sn.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function gp(n,e){const t=vp(e),i=yp(n);if(!await i._isAvailable())return!1;const s=await i._get(t)==="true";return await i._remove(t),s}function _p(n,e){Sn.set(n._key(),e)}function yp(n){return ve(n._redirectPersistence)}function vp(n){return Tn(pp,n.config.apiKey,n.name)}async function wp(n,e,t=!1){const i=cn(n),s=cp(i,e),o=await new mp(i,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const bp=10*60*1e3;class Ip{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Ep(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!_l(e)){const s=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(fe(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=bp&&this.cachedEventUids.clear(),this.cachedEventUids.has(ro(e))}saveEventToCache(e){this.cachedEventUids.add(ro(e)),this.lastProcessedEventTime=Date.now()}}function ro(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function _l({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Ep(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return _l(n);default:return!1}}async function Cp(n,e={}){return an(n,"GET","/v1/projects",e)}const Tp=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Sp=/^https?/;async function kp(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Cp(n);for(const t of e)try{if(Rp(t))return}catch{}ue(n,"unauthorized-domain")}function Rp(n){const e=as(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!Sp.test(t))return!1;if(Tp.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}const Np=new rn(3e4,6e4);function oo(){const n=pe().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Ap(n){return new Promise((e,t)=>{var i,s,r;function o(){oo(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{oo(),t(fe(n,"network-request-failed"))},timeout:Np.get()})}if(!((s=(i=pe().gapi)===null||i===void 0?void 0:i.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((r=pe().gapi)===null||r===void 0)&&r.load)o();else{const a=lp("iframefcb");return pe()[a]=()=>{gapi.load?o():t(fe(n,"network-request-failed"))},ap(`https://apis.google.com/js/api.js?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw kn=null,e})}let kn=null;function xp(n){return kn=kn||Ap(n),kn}const Op=new rn(5e3,15e3),Pp="__/auth/iframe",Dp="emulator/auth/iframe",Mp={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Lp=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Fp(n){const e=n.config;b(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Us(e,Dp):`https://${n.config.authDomain}/${Pp}`,i={apiKey:e.apiKey,appName:n.name,v:sn},s=Lp.get(n.config.apiHost);s&&(i.eid=s);const r=n._getFrameworks();return r.length&&(i.fw=r.join(",")),`${t}?${It(i).slice(1)}`}async function Up(n){const e=await xp(n),t=pe().gapi;return b(t,n,"internal-error"),e.open({where:document.body,url:Fp(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Mp,dontclear:!0},i=>new Promise(async(s,r)=>{await i.restyle({setHideOnLeave:!1});const o=fe(n,"network-request-failed"),a=pe().setTimeout(()=>{r(o)},Op.get());function l(){pe().clearTimeout(a),s(i)}i.ping(l).then(l,()=>{r(o)})}))}const Bp={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Wp=500,Hp=600,jp="_blank",zp="http://localhost";class ao{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function $p(n,e,t,i=Wp,s=Hp){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},Bp),{width:i.toString(),height:s.toString(),top:r,left:o}),c=V().toLowerCase();t&&(a=Qa(c)?jp:t),Ja(c)&&(e=e||zp,l.scrollbars="yes");const u=Object.entries(l).reduce((h,[m,p])=>`${h}${m}=${p},`,"");if(bf(c)&&a!=="_self")return Vp(e||"",a),new ao(null);const d=window.open(e||"",a,u);b(d,n,"popup-blocked");try{d.focus()}catch{}return new ao(d)}function Vp(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const qp="__/auth/handler",Gp="emulator/auth/handler";function lo(n,e,t,i,s,r){b(n.config.authDomain,n,"auth-domain-config-required"),b(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:sn,eventId:s};if(e instanceof rl){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",es(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[l,c]of Object.entries(r||{}))o[l]=c}if(e instanceof un){const l=e.getScopes().filter(c=>c!=="");l.length>0&&(o.scopes=l.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const l of Object.keys(a))a[l]===void 0&&delete a[l];return`${Kp(n)}?${It(a).slice(1)}`}function Kp({config:n}){return n.emulator?Us(n,Gp):`https://${n.authDomain}/${qp}`}const Wi="webStorageSupport";class Yp{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dl,this._completeRedirectFn=wp,this._overrideRedirectResult=_p}async _openPopup(e,t,i,s){var r;Ee((r=this.eventManagers[e._key()])===null||r===void 0?void 0:r.manager,"_initialize() not called before _openPopup()");const o=lo(e,t,i,as(),s);return $p(e,o,zs())}async _openRedirect(e,t,i,s){return await this._originValidation(e),Jf(lo(e,t,i,as(),s)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:r}=this.eventManagers[t];return s?Promise.resolve(s):(Ee(r,"If manager is not set, promise should be"),r)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await Up(e),i=new Ip(e);return t.register("authEvent",s=>(b(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Wi,{type:Wi},s=>{var r;const o=(r=s==null?void 0:s[0])===null||r===void 0?void 0:r[Wi];o!==void 0&&t(!!o),ue(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=kp(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return nl()||Ws()||li()}}const Jp=Yp;var co="@firebase/auth",uo="0.21.3";class Qp{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){b(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Xp(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function Zp(n){me(new ce("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),{apiKey:r,authDomain:o}=i.options;return((a,l)=>{b(r&&!r.includes(":"),"invalid-api-key",{appName:a.name}),b(!(o!=null&&o.includes(":")),"argument-error",{appName:a.name});const c={apiKey:r,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:il(n)},u=new Tf(a,l,c);return sf(u,t),u})(i,s)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),me(new ce("auth-internal",e=>{const t=cn(e.getProvider("auth").getImmediate());return(i=>new Qp(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),te(co,uo,Xp(n)),te(co,uo,"esm2017")}const em=5*60,tm=aa("authIdTokenMaxAge")||em;let ho=null;const nm=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>tm)return;const s=t==null?void 0:t.token;ho!==s&&(ho=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Vs(n=xs()){const e=ot(n,"auth");if(e.isInitialized())return e.getImmediate();const t=nf(n,{popupRedirectResolver:Jp,persistence:[rp,Gf,dl]}),i=aa("authTokenSyncURL");if(i){const r=nm(i);zf(t,r,()=>r(t.currentUser)),jf(t,o=>r(o))}const s=oa("auth");return s&&Sf(t,`http://${s}`),t}Zp("Browser");const fo="@firebase/database",po="0.14.3";let yl="";function im(n){yl=n}class sm{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),L(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:jt(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class rm{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Te(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const vl=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new sm(e)}}catch{}return new rm},qe=vl("localStorage"),cs=vl("sessionStorage");const ft=new ri("@firebase/database"),om=function(){let n=1;return function(){return n++}}(),wl=function(n){const e=ku(n),t=new Eu;t.update(e);const i=t.digest();return Ts.encodeByteArray(i)},hn=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=hn.apply(null,i):typeof i=="object"?e+=L(i):e+=i,e+=" "}return e};let Ye=null,mo=!0;const am=function(n,e){g(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(ft.logLevel=A.VERBOSE,Ye=ft.log.bind(ft),e&&cs.set("logging_enabled",!0)):typeof n=="function"?Ye=n:(Ye=null,cs.remove("logging_enabled"))},$=function(...n){if(mo===!0&&(mo=!1,Ye===null&&cs.get("logging_enabled")===!0&&am(!0)),Ye){const e=hn.apply(null,n);Ye(e)}},fn=function(n){return function(...e){$(n,...e)}},us=function(...n){const e="FIREBASE INTERNAL ERROR: "+hn(...n);ft.error(e)},Ce=function(...n){const e=`FIREBASE FATAL ERROR: ${hn(...n)}`;throw ft.error(e),new Error(e)},J=function(...n){const e="FIREBASE WARNING: "+hn(...n);ft.warn(e)},lm=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&J("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},bl=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},cm=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},_t="[MIN_NAME]",tt="[MAX_NAME]",Ct=function(n,e){if(n===e)return 0;if(n===_t||e===tt)return-1;if(e===_t||n===tt)return 1;{const t=go(n),i=go(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},um=function(n,e){return n===e?0:n<e?-1:1},Nt=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+L(e))},qs=function(n){if(typeof n!="object"||n===null)return L(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=L(e[i]),t+=":",t+=qs(n[e[i]]);return t+="}",t},Il=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let s=0;s<t;s+=e)s+e>t?i.push(n.substring(s,t)):i.push(n.substring(s,s+e));return i};function Q(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const El=function(n){g(!bl(n),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let s,r,o,a,l;n===0?(r=0,o=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),i),r=a+i,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(r=0,o=Math.round(n/Math.pow(2,1-i-t))));const c=[];for(l=t;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(r%2?1:0),r=Math.floor(r/2);c.push(s?1:0),c.reverse();const u=c.join("");let d="";for(l=0;l<64;l+=8){let h=parseInt(u.substr(l,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},dm=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},hm=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function fm(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}const pm=new RegExp("^-?(0*)\\d{1,10}$"),mm=-2147483648,gm=2147483647,go=function(n){if(pm.test(n)){const e=Number(n);if(e>=mm&&e<=gm)return e}return null},Tt=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw J("Exception was thrown by user callback.",t),e},Math.floor(0))}},_m=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Ut=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};class ym{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){J(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class vm{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?($("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',J(e)}}class pt{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}pt.OWNER="owner";const Gs="5",Cl="v",Tl="s",Sl="r",kl="f",Rl=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Nl="ls",Al="p",ds="ac",xl="websocket",Ol="long_polling";class Pl{constructor(e,t,i,s,r=!1,o="",a=!1,l=!1){this.secure=t,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=r,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=qe.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&qe.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function wm(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Dl(n,e,t){g(typeof e=="string","typeof type must == string"),g(typeof t=="object","typeof params must == object");let i;if(e===xl)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===Ol)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);wm(n)&&(t.ns=n.namespace);const s=[];return Q(t,(r,o)=>{s.push(r+"="+o)}),i+s.join("&")}class bm{constructor(){this.counters_={}}incrementCounter(e,t=1){Te(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return au(this.counters_)}}const Hi={},ji={};function Ks(n){const e=n.toString();return Hi[e]||(Hi[e]=new bm),Hi[e]}function Im(n,e){const t=n.toString();return ji[t]||(ji[t]=e()),ji[t]}class Em{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&Tt(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const _o="start",Cm="close",Tm="pLPCommand",Sm="pRTLPCB",Ml="id",Ll="pw",Fl="ser",km="cb",Rm="seg",Nm="ts",Am="d",xm="dframe",Ul=1870,Bl=30,Om=Ul-Bl,Pm=25e3,Dm=3e4;class ut{constructor(e,t,i,s,r,o,a){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=s,this.authToken=r,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=fn(e),this.stats_=Ks(t),this.urlFn=l=>(this.appCheckToken&&(l[ds]=this.appCheckToken),Dl(t,Ol,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Em(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Dm)),cm(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Ys((...r)=>{const[o,a,l,c,u]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===_o)this.id=a,this.password=l;else if(o===Cm)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...r)=>{const[o,a]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const i={};i[_o]="t",i[Fl]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[km]=this.scriptTagHolder.uniqueCallbackIdentifier),i[Cl]=Gs,this.transportSessionId&&(i[Tl]=this.transportSessionId),this.lastSessionId&&(i[Nl]=this.lastSessionId),this.applicationId&&(i[Al]=this.applicationId),this.appCheckToken&&(i[ds]=this.appCheckToken),typeof location<"u"&&location.hostname&&Rl.test(location.hostname)&&(i[Sl]=kl);const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ut.forceAllow_=!0}static forceDisallow(){ut.forceDisallow_=!0}static isAvailable(){return ut.forceAllow_?!0:!ut.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!dm()&&!hm()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=L(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=sa(t),s=Il(i,Om);for(let r=0;r<s.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[r]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[xm]="t",i[Ml]=e,i[Ll]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=L(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Ys{constructor(e,t,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=om(),window[Tm+this.uniqueCallbackIdentifier]=e,window[Sm+this.uniqueCallbackIdentifier]=t,this.myIFrame=Ys.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){$("frame writing exception"),a.stack&&$(a.stack),$(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||$("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[Ml]=this.myID,e[Ll]=this.myPW,e[Fl]=this.currentSerial;let t=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Bl+i.length<=Ul;){const o=this.pendingSegs.shift();i=i+"&"+Rm+s+"="+o.seg+"&"+Nm+s+"="+o.ts+"&"+Am+s+"="+o.d,s++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(i,Math.floor(Pm)),r=()=>{clearTimeout(s),i()};this.addTag(e,r)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{$("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}const Mm=16384,Lm=45e3;let jn=null;typeof MozWebSocket<"u"?jn=MozWebSocket:typeof WebSocket<"u"&&(jn=WebSocket);class re{constructor(e,t,i,s,r,o,a){this.connId=e,this.applicationId=i,this.appCheckToken=s,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=fn(this.connId),this.stats_=Ks(t),this.connURL=re.connectionURL_(t,o,a,s,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,s,r){const o={};return o[Cl]=Gs,typeof location<"u"&&location.hostname&&Rl.test(location.hostname)&&(o[Sl]=kl),t&&(o[Tl]=t),i&&(o[Nl]=i),s&&(o[ds]=s),r&&(o[Al]=r),Dl(e,xl,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,qe.set("previous_websocket_failure",!0);try{let i;ua(),this.mySock=new jn(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){re.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&jn!==null&&!re.forceDisallow_}static previouslyFailed(){return qe.isInMemoryStorage||qe.get("previous_websocket_failure")===!0}markConnectionHealthy(){qe.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=jt(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(g(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=L(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=Il(t,Mm);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Lm))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}re.responsesRequiredToBeHealthy=2;re.healthyTimeout=3e4;class Kt{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[ut,re]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=re&&re.isAvailable();let i=t&&!re.previouslyFailed();if(e.webSocketOnly&&(t||J("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[re];else{const s=this.transports_=[];for(const r of Kt.ALL_TRANSPORTS)r&&r.isAvailable()&&s.push(r);Kt.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Kt.globalTransportInitialized_=!1;const Fm=6e4,Um=5e3,Bm=10*1024,Wm=100*1024,zi="t",yo="d",Hm="s",vo="r",jm="e",wo="o",bo="a",Io="n",Eo="p",zm="h";class $m{constructor(e,t,i,s,r,o,a,l,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=r,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=fn("c:"+this.id+":"),this.transportManager_=new Kt(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=Ut(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Wm?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Bm?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(zi in e){const t=e[zi];t===bo?this.upgradeIfSecondaryHealthy_():t===vo?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===wo&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Nt("t",e),i=Nt("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Eo,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:bo,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Io,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Nt("t",e),i=Nt("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Nt(zi,e);if(yo in e){const i=e[yo];if(t===zm){const s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(t===Io){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Hm?this.onConnectionShutdown_(i):t===vo?this.onReset_(i):t===jm?us("Server Error: "+i):t===wo?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):us("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Gs!==i&&J("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),Ut(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Fm))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ut(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Um))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Eo,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(qe.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Wl{put(e,t,i,s){}merge(e,t,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}class Hl{constructor(e){this.allowedEvents_=e,this.listeners_={},g(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const s=this.getInitialEvent(e);s&&t.apply(i,s)}off(e,t,i){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let r=0;r<s.length;r++)if(s[r].callback===t&&(!i||i===s[r].context)){s.splice(r,1);return}}validateEventType_(e){g(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class zn extends Hl{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ks()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new zn}getInitialEvent(e){return g(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const Co=32,To=768;class x{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function N(){return new x("")}function S(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Be(n){return n.pieces_.length-n.pieceNum_}function O(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new x(n.pieces_,e)}function jl(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Vm(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function zl(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function $l(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new x(e,0)}function F(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof x)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&t.push(i[s])}return new x(t,0)}function T(n){return n.pieceNum_>=n.pieces_.length}function G(n,e){const t=S(n),i=S(e);if(t===null)return e;if(t===i)return G(O(n),O(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Vl(n,e){if(Be(n)!==Be(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function oe(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(Be(n)>Be(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class qm{constructor(e,t){this.errorPrefix_=t,this.parts_=zl(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=si(this.parts_[i]);ql(this)}}function Gm(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=si(e),ql(n)}function Km(n){const e=n.parts_.pop();n.byteLength_-=si(e),n.parts_.length>0&&(n.byteLength_-=1)}function ql(n){if(n.byteLength_>To)throw new Error(n.errorPrefix_+"has a key path longer than "+To+" bytes ("+n.byteLength_+").");if(n.parts_.length>Co)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Co+") or object contains a cycle "+$e(n))}function $e(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}class Js extends Hl{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new Js}getInitialEvent(e){return g(e==="visible","Unknown event type: "+e),[this.visible_]}}const At=1e3,Ym=60*5*1e3,So=30*1e3,Jm=1.3,Qm=3e4,Xm="server_kill",ko=3;class be extends Wl{constructor(e,t,i,s,r,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=be.nextPersistentConnectionId_++,this.log_=fn("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=At,this.maxReconnectDelay_=Ym,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!ua())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Js.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&zn.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const s=++this.requestNumber_,r={r:s,a:e,b:t};this.log_(L(r)),g(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),i&&(this.requestCBHash_[s]=i)}get(e){this.initConnection_();const t=new ii,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?t.resolve(a):t.reject(a)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,i,s){this.initConnection_();const r=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),g(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),g(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:t,query:e,tag:i};this.listens.get(o).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+i+" for "+s);const r={p:i},o="q";e.tag&&(r.q=t._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(o,r,a=>{const l=a.d,c=a.s;be.warnOnListenWarnings_(l,t),(this.listens.get(i)&&this.listens.get(i).get(s))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(i,s),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Te(e,"w")){const i=gt(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+t._queryParams.getIndex().toString()+'"',r=t._path.toString();J(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Iu(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=So)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=bu(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,s=>{const r=s.s,o=s.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),g(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,e._queryObject,t)}sendUnlisten_(e,t,i,s){this.log_("Unlisten on "+e+" for "+t);const r={p:e},o="n";s&&(r.q=i,r.t=s),this.sendRequest(o,r)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,s){const r={p:t,d:i};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,o=>{s&&setTimeout(()=>{s(o.s,o.d)},Math.floor(0))})}put(e,t,i,s){this.putInternal("p",e,t,i,s)}merge(e,t,i,s){this.putInternal("m",e,t,i,s)}putInternal(e,t,i,s,r){this.initConnection_();const o={p:t,d:i};r!==void 0&&(o.h=r),this.outstandingPuts_.push({action:e,request:o,onComplete:s}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,r=>{this.log_(t+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(r.s,r.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const r=i.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+L(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):us("Unrecognized action received from server: "+L(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){g(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=At,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=At,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Qm&&(this.reconnectDelay_=At),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Jm)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+be.nextConnectionId_++,r=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,i())},c=function(d){g(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,h]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?$("getToken() completed but was canceled"):($("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=h&&h.token,a=new $m(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,m=>{J(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(Xm)},r))}catch(d){this.log_("Failed to get token: "+d),o||(this.repoInfo_.nodeAdmin&&J(d),l())}}}interrupt(e){$("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){$("Resuming connection for reason: "+e),delete this.interruptReasons_[e],es(this.interruptReasons_)&&(this.reconnectDelay_=At,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(r=>qs(r)).join("$"):i="default";const s=this.removeListen_(e,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const i=new x(e).toString();let s;if(this.listens.has(i)){const r=this.listens.get(i);s=r.get(t),r.delete(t),r.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(e,t){$("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=ko&&(this.reconnectDelay_=So,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){$("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=ko&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+yl.replace(/\./g,"-")]=1,ks()?e["framework.cordova"]=1:ca()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=zn.getInstance().currentlyOnline();return es(this.interruptReasons_)&&e}}be.nextPersistentConnectionId_=0;be.nextConnectionId_=0;class C{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new C(e,t)}}class di{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new C(_t,e),s=new C(_t,t);return this.compare(i,s)!==0}minPost(){return C.MIN}}let In;class Gl extends di{static get __EMPTY_NODE(){return In}static set __EMPTY_NODE(e){In=e}compare(e,t){return Ct(e.name,t.name)}isDefinedOn(e){throw bt("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return C.MIN}maxPost(){return new C(tt,In)}makePost(e,t){return g(typeof e=="string","KeyIndex indexValue must always be a string."),new C(e,In)}toString(){return".key"}}const mt=new Gl;class En{constructor(e,t,i,s,r=null){this.isReverse_=s,this.resultGenerator_=r,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?i(e.key,t):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class W{constructor(e,t,i,s,r){this.key=e,this.value=t,this.color=i??W.RED,this.left=s??Y.EMPTY_NODE,this.right=r??Y.EMPTY_NODE}copy(e,t,i,s,r){return new W(e??this.key,t??this.value,i??this.color,s??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const r=i(e,s.key);return r<0?s=s.copy(null,null,null,s.left.insert(e,t,i),null):r===0?s=s.copy(null,t,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Y.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,s;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return Y.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,W.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,W.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}W.RED=!0;W.BLACK=!1;class Zm{copy(e,t,i,s,r){return this}insert(e,t,i){return new W(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Y{constructor(e,t=Y.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Y(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,W.BLACK,null,null))}remove(e){return new Y(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,W.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,s=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new En(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new En(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new En(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new En(this.root_,null,this.comparator_,!0,e)}}Y.EMPTY_NODE=new Zm;function eg(n,e){return Ct(n.name,e.name)}function Qs(n,e){return Ct(n,e)}let hs;function tg(n){hs=n}const Kl=function(n){return typeof n=="number"?"number:"+El(n):"string:"+n},Yl=function(n){if(n.isLeafNode()){const e=n.val();g(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Te(e,".sv"),"Priority must be a string or number.")}else g(n===hs||n.isEmpty(),"priority of unexpected type.");g(n===hs||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Ro;class B{constructor(e,t=B.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,g(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Yl(this.priorityNode_)}static set __childrenNodeConstructor(e){Ro=e}static get __childrenNodeConstructor(){return Ro}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new B(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:B.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return T(e)?this:S(e)===".priority"?this.priorityNode_:B.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:B.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=S(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:(g(i!==".priority"||Be(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,B.__childrenNodeConstructor.EMPTY_NODE.updateChild(O(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Kl(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=El(this.value_):e+=this.value_,this.lazyHash_=wl(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===B.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof B.__childrenNodeConstructor?-1:(g(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,s=B.VALUE_TYPE_ORDER.indexOf(t),r=B.VALUE_TYPE_ORDER.indexOf(i);return g(s>=0,"Unknown leaf type: "+t),g(r>=0,"Unknown leaf type: "+i),s===r?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}B.VALUE_TYPE_ORDER=["object","boolean","number","string"];let Jl,Ql;function ng(n){Jl=n}function ig(n){Ql=n}class sg extends di{compare(e,t){const i=e.node.getPriority(),s=t.node.getPriority(),r=i.compareTo(s);return r===0?Ct(e.name,t.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return C.MIN}maxPost(){return new C(tt,new B("[PRIORITY-POST]",Ql))}makePost(e,t){const i=Jl(e);return new C(t,new B("[PRIORITY-POST]",i))}toString(){return".priority"}}const D=new sg;const rg=Math.log(2);class og{constructor(e){const t=r=>parseInt(Math.log(r)/rg,10),i=r=>parseInt(Array(r+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const $n=function(n,e,t,i){n.sort(e);const s=function(l,c){const u=c-l;let d,h;if(u===0)return null;if(u===1)return d=n[l],h=t?t(d):d,new W(h,d.node,W.BLACK,null,null);{const m=parseInt(u/2,10)+l,p=s(l,m),_=s(m+1,c);return d=n[m],h=t?t(d):d,new W(h,d.node,W.BLACK,p,_)}},r=function(l){let c=null,u=null,d=n.length;const h=function(p,_){const k=d-p,y=d;d-=p;const I=s(k+1,y),E=n[k],X=t?t(E):E;m(new W(X,E.node,_,null,I))},m=function(p){c?(c.left=p,c=p):(u=p,c=p)};for(let p=0;p<l.count;++p){const _=l.nextBitIsOne(),k=Math.pow(2,l.count-(p+1));_?h(k,W.BLACK):(h(k,W.BLACK),h(k,W.RED))}return u},o=new og(n.length),a=r(o);return new Y(i||e,a)};let $i;const lt={};class we{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return g(lt&&D,"ChildrenNode.ts has not been loaded"),$i=$i||new we({".priority":lt},{".priority":D}),$i}get(e){const t=gt(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Y?t:null}hasIndex(e){return Te(this.indexSet_,e.toString())}addIndex(e,t){g(e!==mt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const r=t.getIterator(C.Wrap);let o=r.getNext();for(;o;)s=s||e.isDefinedOn(o.node),i.push(o),o=r.getNext();let a;s?a=$n(i,e.getCompare()):a=lt;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const u=Object.assign({},this.indexes_);return u[l]=a,new we(u,c)}addToIndexes(e,t){const i=Dn(this.indexes_,(s,r)=>{const o=gt(this.indexSet_,r);if(g(o,"Missing index implementation for "+r),s===lt)if(o.isDefinedOn(e.node)){const a=[],l=t.getIterator(C.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),$n(a,o.getCompare())}else return lt;else{const a=t.get(e.name);let l=s;return a&&(l=l.remove(new C(e.name,a))),l.insert(e,e.node)}});return new we(i,this.indexSet_)}removeFromIndexes(e,t){const i=Dn(this.indexes_,s=>{if(s===lt)return s;{const r=t.get(e.name);return r?s.remove(new C(e.name,r)):s}});return new we(i,this.indexSet_)}}let xt;class w{constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&Yl(this.priorityNode_),this.children_.isEmpty()&&g(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return xt||(xt=new w(new Y(Qs),null,we.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||xt}updatePriority(e){return this.children_.isEmpty()?this:new w(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?xt:t}}getChild(e){const t=S(e);return t===null?this:this.getImmediateChild(t).getChild(O(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(g(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new C(e,t);let s,r;t.isEmpty()?(s=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(e,t),r=this.indexMap_.addToIndexes(i,this.children_));const o=s.isEmpty()?xt:this.priorityNode_;return new w(s,o,r)}}updateChild(e,t){const i=S(e);if(i===null)return t;{g(S(e)!==".priority"||Be(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(O(e),t);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,s=0,r=!0;if(this.forEachChild(D,(o,a)=>{t[o]=a.val(e),i++,r&&w.INTEGER_REGEXP_.test(o)?s=Math.max(s,Number(o)):r=!1}),!e&&r&&s<2*i){const o=[];for(const a in t)o[a]=t[a];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Kl(this.getPriority().val())+":"),this.forEachChild(D,(t,i)=>{const s=i.hash();s!==""&&(e+=":"+t+":"+s)}),this.lazyHash_=e===""?"":wl(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const s=this.resolveIndex_(i);if(s){const r=s.getPredecessorKey(new C(e,t));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new C(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new C(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(s=>t(s.name,s.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,C.Wrap);let r=s.peek();for(;r!=null&&t.compare(r,e)<0;)s.getNext(),r=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,C.Wrap);let r=s.peek();for(;r!=null&&t.compare(r,e)>0;)s.getNext(),r=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===pn?-1:0}withIndex(e){if(e===mt||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new w(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===mt||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(D),s=t.getIterator(D);let r=i.getNext(),o=s.getNext();for(;r&&o;){if(r.name!==o.name||!r.node.equals(o.node))return!1;r=i.getNext(),o=s.getNext()}return r===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===mt?null:this.indexMap_.get(e.toString())}}w.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class ag extends w{constructor(){super(new Y(Qs),w.EMPTY_NODE,we.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return w.EMPTY_NODE}isEmpty(){return!1}}const pn=new ag;Object.defineProperties(C,{MIN:{value:new C(_t,w.EMPTY_NODE)},MAX:{value:new C(tt,pn)}});Gl.__EMPTY_NODE=w.EMPTY_NODE;B.__childrenNodeConstructor=w;tg(pn);ig(pn);const lg=!0;function H(n,e=null){if(n===null)return w.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),g(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new B(t,H(e))}if(!(n instanceof Array)&&lg){const t=[];let i=!1;if(Q(n,(o,a)=>{if(o.substring(0,1)!=="."){const l=H(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),t.push(new C(o,l)))}}),t.length===0)return w.EMPTY_NODE;const r=$n(t,eg,o=>o.name,Qs);if(i){const o=$n(t,D.getCompare());return new w(r,H(e),new we({".priority":o},{".priority":D}))}else return new w(r,H(e),we.Default)}else{let t=w.EMPTY_NODE;return Q(n,(i,s)=>{if(Te(n,i)&&i.substring(0,1)!=="."){const r=H(s);(r.isLeafNode()||!r.isEmpty())&&(t=t.updateImmediateChild(i,r))}}),t.updatePriority(H(e))}}ng(H);class cg extends di{constructor(e){super(),this.indexPath_=e,g(!T(e)&&S(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),s=this.extractChild(t.node),r=i.compareTo(s);return r===0?Ct(e.name,t.name):r}makePost(e,t){const i=H(e),s=w.EMPTY_NODE.updateChild(this.indexPath_,i);return new C(t,s)}maxPost(){const e=w.EMPTY_NODE.updateChild(this.indexPath_,pn);return new C(tt,e)}toString(){return zl(this.indexPath_,0).join("/")}}class ug extends di{compare(e,t){const i=e.node.compareTo(t.node);return i===0?Ct(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return C.MIN}maxPost(){return C.MAX}makePost(e,t){const i=H(e);return new C(t,i)}toString(){return".value"}}const dg=new ug;function Xl(n){return{type:"value",snapshotNode:n}}function yt(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Yt(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Jt(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function hg(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}class Xs{constructor(e){this.index_=e}updateChild(e,t,i,s,r,o){g(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(s).equals(i.getChild(s))&&a.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?e.hasChild(t)?o.trackChildChange(Yt(t,a)):g(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(yt(t,i)):o.trackChildChange(Jt(t,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(D,(s,r)=>{t.hasChild(s)||i.trackChildChange(Yt(s,r))}),t.isLeafNode()||t.forEachChild(D,(s,r)=>{if(e.hasChild(s)){const o=e.getImmediateChild(s);o.equals(r)||i.trackChildChange(Jt(s,r,o))}else i.trackChildChange(yt(s,r))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?w.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Qt{constructor(e){this.indexedFilter_=new Xs(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Qt.getStartPost_(e),this.endPost_=Qt.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,s,r,o){return this.matches(new C(t,i))||(i=w.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,s,r,o)}updateFullNode(e,t,i){t.isLeafNode()&&(t=w.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(w.EMPTY_NODE);const r=this;return t.forEachChild(D,(o,a)=>{r.matches(new C(o,a))||(s=s.updateImmediateChild(o,w.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}class fg{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new Qt(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,s,r,o){return this.rangedFilter_.matches(new C(t,i))||(i=w.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,s,r,o):this.fullLimitUpdateChild_(e,t,i,r,o)}updateFullNode(e,t,i){let s;if(t.isLeafNode()||t.isEmpty())s=w.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){s=w.EMPTY_NODE.withIndex(this.index_);let r;this.reverse_?r=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):r=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;r.hasNext()&&o<this.limit_;){const a=r.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))s=s.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{s=t.withIndex(this.index_),s=s.updatePriority(w.EMPTY_NODE);let r;this.reverse_?r=s.getReverseIterator(this.index_):r=s.getIterator(this.index_);let o=0;for(;r.hasNext();){const a=r.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:s=s.updateImmediateChild(a.name,w.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,s,r){let o;if(this.reverse_){const d=this.index_.getCompare();o=(h,m)=>d(m,h)}else o=this.index_.getCompare();const a=e;g(a.numChildren()===this.limit_,"");const l=new C(t,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(t)){const d=a.getImmediateChild(t);let h=s.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===t||a.hasChild(h.name));)h=s.getChildAfterChild(this.index_,h,this.reverse_);const m=h==null?1:o(h,l);if(u&&!i.isEmpty()&&m>=0)return r!=null&&r.trackChildChange(Jt(t,i,d)),a.updateImmediateChild(t,i);{r!=null&&r.trackChildChange(Yt(t,d));const _=a.updateImmediateChild(t,w.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(r!=null&&r.trackChildChange(yt(h.name,h.node)),_.updateImmediateChild(h.name,h.node)):_}}else return i.isEmpty()?e:u&&o(c,l)>=0?(r!=null&&(r.trackChildChange(Yt(c.name,c.node)),r.trackChildChange(yt(t,i))),a.updateImmediateChild(t,i).updateImmediateChild(c.name,w.EMPTY_NODE)):e}}class Zs{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=D}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return g(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return g(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:_t}hasEnd(){return this.endSet_}getIndexEndValue(){return g(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return g(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:tt}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return g(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===D}copy(){const e=new Zs;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function pg(n){return n.loadsAllData()?new Xs(n.getIndex()):n.hasLimit()?new fg(n):new Qt(n)}function No(n){const e={};if(n.isDefault())return e;let t;if(n.index_===D?t="$priority":n.index_===dg?t="$value":n.index_===mt?t="$key":(g(n.index_ instanceof cg,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=L(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=L(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+L(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=L(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+L(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function Ao(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==D&&(e.i=n.index_.toString()),e}class Vn extends Wl{constructor(e,t,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=fn("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(g(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,s){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const o=Vn.getListenId_(e,i),a={};this.listens_[o]=a;const l=No(e._queryParams);this.restRequest_(r+".json",l,(c,u)=>{let d=u;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(r,d,!1,i),gt(this.listens_,o)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",s(h,null)}})}unlisten(e,t){const i=Vn.getListenId_(e,t);delete this.listens_[i]}get(e){const t=No(e._queryParams),i=e._path.toString(),s=new ii;return this.restRequest_(i+".json",t,(r,o)=>{let a=o;r===404&&(a=null,r=null),r===null?(this.onDataUpdate_(i,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,r])=>{s&&s.accessToken&&(t.auth=s.accessToken),r&&r.token&&(t.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+It(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=jt(a.responseText)}catch{J("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&J("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}}class mg{constructor(){this.rootNode_=w.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function qn(){return{value:null,children:new Map}}function Zl(n,e,t){if(T(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const i=S(e);n.children.has(i)||n.children.set(i,qn());const s=n.children.get(i);e=O(e),Zl(s,e,t)}}function fs(n,e,t){n.value!==null?t(e,n.value):gg(n,(i,s)=>{const r=new x(e.toString()+"/"+i);fs(s,r,t)})}function gg(n,e){n.children.forEach((t,i)=>{e(i,t)})}class _g{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Q(this.last_,(i,s)=>{t[i]=t[i]-s}),this.last_=e,t}}const xo=10*1e3,yg=30*1e3,vg=5*60*1e3;class wg{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new _g(e);const i=xo+(yg-xo)*Math.random();Ut(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;Q(e,(s,r)=>{r>0&&Te(this.statsToReport_,s)&&(t[s]=r,i=!0)}),i&&this.server_.reportStats(t),Ut(this.reportStats_.bind(this),Math.floor(Math.random()*2*vg))}}var ae;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(ae||(ae={}));function ec(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function er(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function tr(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class Gn{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=ae.ACK_USER_WRITE,this.source=ec()}operationForChild(e){if(T(this.path)){if(this.affectedTree.value!=null)return g(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new x(e));return new Gn(N(),t,this.revert)}}else return g(S(this.path)===e,"operationForChild called for unrelated child."),new Gn(O(this.path),this.affectedTree,this.revert)}}class Xt{constructor(e,t){this.source=e,this.path=t,this.type=ae.LISTEN_COMPLETE}operationForChild(e){return T(this.path)?new Xt(this.source,N()):new Xt(this.source,O(this.path))}}class nt{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=ae.OVERWRITE}operationForChild(e){return T(this.path)?new nt(this.source,N(),this.snap.getImmediateChild(e)):new nt(this.source,O(this.path),this.snap)}}class Zt{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=ae.MERGE}operationForChild(e){if(T(this.path)){const t=this.children.subtree(new x(e));return t.isEmpty()?null:t.value?new nt(this.source,N(),t.value):new Zt(this.source,N(),t)}else return g(S(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Zt(this.source,O(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class We{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(T(e))return this.isFullyInitialized()&&!this.filtered_;const t=S(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class bg{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Ig(n,e,t,i){const s=[],r=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&r.push(hg(o.childName,o.snapshotNode))}),Ot(n,s,"child_removed",e,i,t),Ot(n,s,"child_added",e,i,t),Ot(n,s,"child_moved",r,i,t),Ot(n,s,"child_changed",e,i,t),Ot(n,s,"value",e,i,t),s}function Ot(n,e,t,i,s,r){const o=i.filter(a=>a.type===t);o.sort((a,l)=>Cg(n,a,l)),o.forEach(a=>{const l=Eg(n,a,r);s.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,n.query_))})})}function Eg(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Cg(n,e,t){if(e.childName==null||t.childName==null)throw bt("Should only compare child_ events.");const i=new C(e.childName,e.snapshotNode),s=new C(t.childName,t.snapshotNode);return n.index_.compare(i,s)}function hi(n,e){return{eventCache:n,serverCache:e}}function Bt(n,e,t,i){return hi(new We(e,t,i),n.serverCache)}function tc(n,e,t,i){return hi(n.eventCache,new We(e,t,i))}function Kn(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function it(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let Vi;const Tg=()=>(Vi||(Vi=new Y(um)),Vi);class P{constructor(e,t=Tg()){this.value=e,this.children=t}static fromObject(e){let t=new P(null);return Q(e,(i,s)=>{t=t.set(new x(i),s)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:N(),value:this.value};if(T(e))return null;{const i=S(e),s=this.children.get(i);if(s!==null){const r=s.findRootMostMatchingPathAndValue(O(e),t);return r!=null?{path:F(new x(i),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(T(e))return this;{const t=S(e),i=this.children.get(t);return i!==null?i.subtree(O(e)):new P(null)}}set(e,t){if(T(e))return new P(t,this.children);{const i=S(e),r=(this.children.get(i)||new P(null)).set(O(e),t),o=this.children.insert(i,r);return new P(this.value,o)}}remove(e){if(T(e))return this.children.isEmpty()?new P(null):new P(null,this.children);{const t=S(e),i=this.children.get(t);if(i){const s=i.remove(O(e));let r;return s.isEmpty()?r=this.children.remove(t):r=this.children.insert(t,s),this.value===null&&r.isEmpty()?new P(null):new P(this.value,r)}else return this}}get(e){if(T(e))return this.value;{const t=S(e),i=this.children.get(t);return i?i.get(O(e)):null}}setTree(e,t){if(T(e))return t;{const i=S(e),r=(this.children.get(i)||new P(null)).setTree(O(e),t);let o;return r.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,r),new P(this.value,o)}}fold(e){return this.fold_(N(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((s,r)=>{i[s]=r.fold_(F(e,s),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,N(),t)}findOnPath_(e,t,i){const s=this.value?i(t,this.value):!1;if(s)return s;if(T(e))return null;{const r=S(e),o=this.children.get(r);return o?o.findOnPath_(O(e),F(t,r),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,N(),t)}foreachOnPath_(e,t,i){if(T(e))return this;{this.value&&i(t,this.value);const s=S(e),r=this.children.get(s);return r?r.foreachOnPath_(O(e),F(t,s),i):new P(null)}}foreach(e){this.foreach_(N(),e)}foreach_(e,t){this.children.inorderTraversal((i,s)=>{s.foreach_(F(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}class le{constructor(e){this.writeTree_=e}static empty(){return new le(new P(null))}}function Wt(n,e,t){if(T(e))return new le(new P(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){const s=i.path;let r=i.value;const o=G(s,e);return r=r.updateChild(o,t),new le(n.writeTree_.set(s,r))}else{const s=new P(t),r=n.writeTree_.setTree(e,s);return new le(r)}}}function Oo(n,e,t){let i=n;return Q(t,(s,r)=>{i=Wt(i,F(e,s),r)}),i}function Po(n,e){if(T(e))return le.empty();{const t=n.writeTree_.setTree(e,new P(null));return new le(t)}}function ps(n,e){return at(n,e)!=null}function at(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(G(t.path,e)):null}function Do(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(D,(i,s)=>{e.push(new C(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new C(i,s.value))}),e}function Fe(n,e){if(T(e))return n;{const t=at(n,e);return t!=null?new le(new P(t)):new le(n.writeTree_.subtree(e))}}function ms(n){return n.writeTree_.isEmpty()}function vt(n,e){return nc(N(),n.writeTree_,e)}function nc(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((s,r)=>{s===".priority"?(g(r.value!==null,"Priority writes must always be leaf nodes"),i=r.value):t=nc(F(n,s),r,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(F(n,".priority"),i)),t}}function fi(n,e){return oc(e,n)}function Sg(n,e,t,i,s){g(i>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:s}),s&&(n.visibleWrites=Wt(n.visibleWrites,e,t)),n.lastWriteId=i}function kg(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}function Rg(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);g(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let s=i.visible,r=!1,o=n.allWrites.length-1;for(;s&&o>=0;){const a=n.allWrites[o];a.visible&&(o>=t&&Ng(a,i.path)?s=!1:oe(i.path,a.path)&&(r=!0)),o--}if(s){if(r)return Ag(n),!0;if(i.snap)n.visibleWrites=Po(n.visibleWrites,i.path);else{const a=i.children;Q(a,l=>{n.visibleWrites=Po(n.visibleWrites,F(i.path,l))})}return!0}else return!1}function Ng(n,e){if(n.snap)return oe(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&oe(F(n.path,t),e))return!0;return!1}function Ag(n){n.visibleWrites=ic(n.allWrites,xg,N()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function xg(n){return n.visible}function ic(n,e,t){let i=le.empty();for(let s=0;s<n.length;++s){const r=n[s];if(e(r)){const o=r.path;let a;if(r.snap)oe(t,o)?(a=G(t,o),i=Wt(i,a,r.snap)):oe(o,t)&&(a=G(o,t),i=Wt(i,N(),r.snap.getChild(a)));else if(r.children){if(oe(t,o))a=G(t,o),i=Oo(i,a,r.children);else if(oe(o,t))if(a=G(o,t),T(a))i=Oo(i,N(),r.children);else{const l=gt(r.children,S(a));if(l){const c=l.getChild(O(a));i=Wt(i,N(),c)}}}else throw bt("WriteRecord should have .snap or .children")}}return i}function sc(n,e,t,i,s){if(!i&&!s){const r=at(n.visibleWrites,e);if(r!=null)return r;{const o=Fe(n.visibleWrites,e);if(ms(o))return t;if(t==null&&!ps(o,N()))return null;{const a=t||w.EMPTY_NODE;return vt(o,a)}}}else{const r=Fe(n.visibleWrites,e);if(!s&&ms(r))return t;if(!s&&t==null&&!ps(r,N()))return null;{const o=function(c){return(c.visible||s)&&(!i||!~i.indexOf(c.writeId))&&(oe(c.path,e)||oe(e,c.path))},a=ic(n.allWrites,o,e),l=t||w.EMPTY_NODE;return vt(a,l)}}}function Og(n,e,t){let i=w.EMPTY_NODE;const s=at(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(D,(r,o)=>{i=i.updateImmediateChild(r,o)}),i;if(t){const r=Fe(n.visibleWrites,e);return t.forEachChild(D,(o,a)=>{const l=vt(Fe(r,new x(o)),a);i=i.updateImmediateChild(o,l)}),Do(r).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{const r=Fe(n.visibleWrites,e);return Do(r).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function Pg(n,e,t,i,s){g(i||s,"Either existingEventSnap or existingServerSnap must exist");const r=F(e,t);if(ps(n.visibleWrites,r))return null;{const o=Fe(n.visibleWrites,r);return ms(o)?s.getChild(t):vt(o,s.getChild(t))}}function Dg(n,e,t,i){const s=F(e,t),r=at(n.visibleWrites,s);if(r!=null)return r;if(i.isCompleteForChild(t)){const o=Fe(n.visibleWrites,s);return vt(o,i.getNode().getImmediateChild(t))}else return null}function Mg(n,e){return at(n.visibleWrites,e)}function Lg(n,e,t,i,s,r,o){let a;const l=Fe(n.visibleWrites,e),c=at(l,N());if(c!=null)a=c;else if(t!=null)a=vt(l,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],d=o.getCompare(),h=r?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let m=h.getNext();for(;m&&u.length<s;)d(m,i)!==0&&u.push(m),m=h.getNext();return u}else return[]}function Fg(){return{visibleWrites:le.empty(),allWrites:[],lastWriteId:-1}}function Yn(n,e,t,i){return sc(n.writeTree,n.treePath,e,t,i)}function nr(n,e){return Og(n.writeTree,n.treePath,e)}function Mo(n,e,t,i){return Pg(n.writeTree,n.treePath,e,t,i)}function Jn(n,e){return Mg(n.writeTree,F(n.treePath,e))}function Ug(n,e,t,i,s,r){return Lg(n.writeTree,n.treePath,e,t,i,s,r)}function ir(n,e,t){return Dg(n.writeTree,n.treePath,e,t)}function rc(n,e){return oc(F(n.treePath,e),n.writeTree)}function oc(n,e){return{treePath:n,writeTree:e}}class Bg{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;g(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),g(i!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const r=s.type;if(t==="child_added"&&r==="child_removed")this.changeMap.set(i,Jt(i,e.snapshotNode,s.snapshotNode));else if(t==="child_removed"&&r==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&r==="child_changed")this.changeMap.set(i,Yt(i,s.oldSnap));else if(t==="child_changed"&&r==="child_added")this.changeMap.set(i,yt(i,e.snapshotNode));else if(t==="child_changed"&&r==="child_changed")this.changeMap.set(i,Jt(i,e.snapshotNode,s.oldSnap));else throw bt("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}class Wg{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const ac=new Wg;class sr{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new We(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ir(this.writes_,e,i)}}getChildAfterChild(e,t,i){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:it(this.viewCache_),r=Ug(this.writes_,s,t,1,i,e);return r.length===0?null:r[0]}}function Hg(n){return{filter:n}}function jg(n,e){g(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),g(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function zg(n,e,t,i,s){const r=new Bg;let o,a;if(t.type===ae.OVERWRITE){const c=t;c.source.fromUser?o=gs(n,e,c.path,c.snap,i,s,r):(g(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!T(c.path),o=Qn(n,e,c.path,c.snap,i,s,a,r))}else if(t.type===ae.MERGE){const c=t;c.source.fromUser?o=Vg(n,e,c.path,c.children,i,s,r):(g(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=_s(n,e,c.path,c.children,i,s,a,r))}else if(t.type===ae.ACK_USER_WRITE){const c=t;c.revert?o=Kg(n,e,c.path,i,s,r):o=qg(n,e,c.path,c.affectedTree,i,s,r)}else if(t.type===ae.LISTEN_COMPLETE)o=Gg(n,e,t.path,i,r);else throw bt("Unknown operation type: "+t.type);const l=r.getChanges();return $g(e,o,l),{viewCache:o,changes:l}}function $g(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),r=Kn(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(r)||!i.getNode().getPriority().equals(r.getPriority()))&&t.push(Xl(Kn(e)))}}function lc(n,e,t,i,s,r){const o=e.eventCache;if(Jn(i,t)!=null)return e;{let a,l;if(T(t))if(g(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=it(e),u=c instanceof w?c:w.EMPTY_NODE,d=nr(i,u);a=n.filter.updateFullNode(e.eventCache.getNode(),d,r)}else{const c=Yn(i,it(e));a=n.filter.updateFullNode(e.eventCache.getNode(),c,r)}else{const c=S(t);if(c===".priority"){g(Be(t)===1,"Can't have a priority with additional path components");const u=o.getNode();l=e.serverCache.getNode();const d=Mo(i,t,u,l);d!=null?a=n.filter.updatePriority(u,d):a=o.getNode()}else{const u=O(t);let d;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const h=Mo(i,t,o.getNode(),l);h!=null?d=o.getNode().getImmediateChild(c).updateChild(u,h):d=o.getNode().getImmediateChild(c)}else d=ir(i,c,e.serverCache);d!=null?a=n.filter.updateChild(o.getNode(),c,d,u,s,r):a=o.getNode()}}return Bt(e,a,o.isFullyInitialized()||T(t),n.filter.filtersNodes())}}function Qn(n,e,t,i,s,r,o,a){const l=e.serverCache;let c;const u=o?n.filter:n.filter.getIndexedFilter();if(T(t))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){const m=l.getNode().updateChild(t,i);c=u.updateFullNode(l.getNode(),m,null)}else{const m=S(t);if(!l.isCompleteForPath(t)&&Be(t)>1)return e;const p=O(t),k=l.getNode().getImmediateChild(m).updateChild(p,i);m===".priority"?c=u.updatePriority(l.getNode(),k):c=u.updateChild(l.getNode(),m,k,p,ac,null)}const d=tc(e,c,l.isFullyInitialized()||T(t),u.filtersNodes()),h=new sr(s,d,r);return lc(n,d,t,s,h,a)}function gs(n,e,t,i,s,r,o){const a=e.eventCache;let l,c;const u=new sr(s,e,r);if(T(t))c=n.filter.updateFullNode(e.eventCache.getNode(),i,o),l=Bt(e,c,!0,n.filter.filtersNodes());else{const d=S(t);if(d===".priority")c=n.filter.updatePriority(e.eventCache.getNode(),i),l=Bt(e,c,a.isFullyInitialized(),a.isFiltered());else{const h=O(t),m=a.getNode().getImmediateChild(d);let p;if(T(h))p=i;else{const _=u.getCompleteChild(d);_!=null?jl(h)===".priority"&&_.getChild($l(h)).isEmpty()?p=_:p=_.updateChild(h,i):p=w.EMPTY_NODE}if(m.equals(p))l=e;else{const _=n.filter.updateChild(a.getNode(),d,p,h,u,o);l=Bt(e,_,a.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function Lo(n,e){return n.eventCache.isCompleteForChild(e)}function Vg(n,e,t,i,s,r,o){let a=e;return i.foreach((l,c)=>{const u=F(t,l);Lo(e,S(u))&&(a=gs(n,a,u,c,s,r,o))}),i.foreach((l,c)=>{const u=F(t,l);Lo(e,S(u))||(a=gs(n,a,u,c,s,r,o))}),a}function Fo(n,e,t){return t.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function _s(n,e,t,i,s,r,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;T(t)?c=i:c=new P(null).setTree(t,i);const u=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){const m=e.serverCache.getNode().getImmediateChild(d),p=Fo(n,m,h);l=Qn(n,l,new x(d),p,s,r,o,a)}}),c.children.inorderTraversal((d,h)=>{const m=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!u.hasChild(d)&&!m){const p=e.serverCache.getNode().getImmediateChild(d),_=Fo(n,p,h);l=Qn(n,l,new x(d),_,s,r,o,a)}}),l}function qg(n,e,t,i,s,r,o){if(Jn(s,t)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(T(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return Qn(n,e,t,l.getNode().getChild(t),s,r,a,o);if(T(t)){let c=new P(null);return l.getNode().forEachChild(mt,(u,d)=>{c=c.set(new x(u),d)}),_s(n,e,t,c,s,r,a,o)}else return e}else{let c=new P(null);return i.foreach((u,d)=>{const h=F(t,u);l.isCompleteForPath(h)&&(c=c.set(u,l.getNode().getChild(h)))}),_s(n,e,t,c,s,r,a,o)}}function Gg(n,e,t,i,s){const r=e.serverCache,o=tc(e,r.getNode(),r.isFullyInitialized()||T(t),r.isFiltered());return lc(n,o,t,i,ac,s)}function Kg(n,e,t,i,s,r){let o;if(Jn(i,t)!=null)return e;{const a=new sr(i,e,s),l=e.eventCache.getNode();let c;if(T(t)||S(t)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Yn(i,it(e));else{const d=e.serverCache.getNode();g(d instanceof w,"serverChildren would be complete if leaf node"),u=nr(i,d)}u=u,c=n.filter.updateFullNode(l,u,r)}else{const u=S(t);let d=ir(i,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=l.getImmediateChild(u)),d!=null?c=n.filter.updateChild(l,u,d,O(t),a,r):e.eventCache.getNode().hasChild(u)?c=n.filter.updateChild(l,u,w.EMPTY_NODE,O(t),a,r):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Yn(i,it(e)),o.isLeafNode()&&(c=n.filter.updateFullNode(c,o,r)))}return o=e.serverCache.isFullyInitialized()||Jn(i,N())!=null,Bt(e,c,o,n.filter.filtersNodes())}}class Yg{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new Xs(i.getIndex()),r=pg(i);this.processor_=Hg(r);const o=t.serverCache,a=t.eventCache,l=s.updateFullNode(w.EMPTY_NODE,o.getNode(),null),c=r.updateFullNode(w.EMPTY_NODE,a.getNode(),null),u=new We(l,o.isFullyInitialized(),s.filtersNodes()),d=new We(c,a.isFullyInitialized(),r.filtersNodes());this.viewCache_=hi(d,u),this.eventGenerator_=new bg(this.query_)}get query(){return this.query_}}function Jg(n){return n.viewCache_.serverCache.getNode()}function Qg(n){return Kn(n.viewCache_)}function Xg(n,e){const t=it(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!T(e)&&!t.getImmediateChild(S(e)).isEmpty())?t.getChild(e):null}function Uo(n){return n.eventRegistrations_.length===0}function Zg(n,e){n.eventRegistrations_.push(e)}function Bo(n,e,t){const i=[];if(t){g(e==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(r=>{const o=r.createCancelEvent(t,s);o&&i.push(o)})}if(e){let s=[];for(let r=0;r<n.eventRegistrations_.length;++r){const o=n.eventRegistrations_[r];if(!o.matches(e))s.push(o);else if(e.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(r+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function Wo(n,e,t,i){e.type===ae.MERGE&&e.source.queryId!==null&&(g(it(n.viewCache_),"We should always have a full cache before handling merges"),g(Kn(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,r=zg(n.processor_,s,e,t,i);return jg(n.processor_,r.viewCache),g(r.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=r.viewCache,cc(n,r.changes,r.viewCache.eventCache.getNode(),null)}function e_(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(D,(r,o)=>{i.push(yt(r,o))}),t.isFullyInitialized()&&i.push(Xl(t.getNode())),cc(n,i,t.getNode(),e)}function cc(n,e,t,i){const s=i?[i]:n.eventRegistrations_;return Ig(n.eventGenerator_,e,t,s)}let Xn;class uc{constructor(){this.views=new Map}}function t_(n){g(!Xn,"__referenceConstructor has already been defined"),Xn=n}function n_(){return g(Xn,"Reference.ts has not been loaded"),Xn}function i_(n){return n.views.size===0}function rr(n,e,t,i){const s=e.source.queryId;if(s!==null){const r=n.views.get(s);return g(r!=null,"SyncTree gave us an op for an invalid query."),Wo(r,e,t,i)}else{let r=[];for(const o of n.views.values())r=r.concat(Wo(o,e,t,i));return r}}function dc(n,e,t,i,s){const r=e._queryIdentifier,o=n.views.get(r);if(!o){let a=Yn(t,s?i:null),l=!1;a?l=!0:i instanceof w?(a=nr(t,i),l=!1):(a=w.EMPTY_NODE,l=!1);const c=hi(new We(a,l,!1),new We(i,s,!1));return new Yg(e,c)}return o}function s_(n,e,t,i,s,r){const o=dc(n,e,i,s,r);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),Zg(o,t),e_(o,t)}function r_(n,e,t,i){const s=e._queryIdentifier,r=[];let o=[];const a=He(n);if(s==="default")for(const[l,c]of n.views.entries())o=o.concat(Bo(c,t,i)),Uo(c)&&(n.views.delete(l),c.query._queryParams.loadsAllData()||r.push(c.query));else{const l=n.views.get(s);l&&(o=o.concat(Bo(l,t,i)),Uo(l)&&(n.views.delete(s),l.query._queryParams.loadsAllData()||r.push(l.query)))}return a&&!He(n)&&r.push(new(n_())(e._repo,e._path)),{removed:r,events:o}}function hc(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Ue(n,e){let t=null;for(const i of n.views.values())t=t||Xg(i,e);return t}function fc(n,e){if(e._queryParams.loadsAllData())return pi(n);{const i=e._queryIdentifier;return n.views.get(i)}}function pc(n,e){return fc(n,e)!=null}function He(n){return pi(n)!=null}function pi(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let Zn;function o_(n){g(!Zn,"__referenceConstructor has already been defined"),Zn=n}function a_(){return g(Zn,"Reference.ts has not been loaded"),Zn}let l_=1;class Ho{constructor(e){this.listenProvider_=e,this.syncPointTree_=new P(null),this.pendingWriteTree_=Fg(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function mc(n,e,t,i,s){return Sg(n.pendingWriteTree_,e,t,i,s),s?gn(n,new nt(ec(),e,t)):[]}function Ge(n,e,t=!1){const i=kg(n.pendingWriteTree_,e);if(Rg(n.pendingWriteTree_,e)){let r=new P(null);return i.snap!=null?r=r.set(N(),!0):Q(i.children,o=>{r=r.set(new x(o),!0)}),gn(n,new Gn(i.path,r,t))}else return[]}function mn(n,e,t){return gn(n,new nt(er(),e,t))}function c_(n,e,t){const i=P.fromObject(t);return gn(n,new Zt(er(),e,i))}function u_(n,e){return gn(n,new Xt(er(),e))}function d_(n,e,t){const i=ar(n,t);if(i){const s=lr(i),r=s.path,o=s.queryId,a=G(r,e),l=new Xt(tr(o),a);return cr(n,r,l)}else return[]}function gc(n,e,t,i,s=!1){const r=e._path,o=n.syncPointTree_.get(r);let a=[];if(o&&(e._queryIdentifier==="default"||pc(o,e))){const l=r_(o,e,t,i);i_(o)&&(n.syncPointTree_=n.syncPointTree_.remove(r));const c=l.removed;if(a=l.events,!s){const u=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=n.syncPointTree_.findOnPath(r,(h,m)=>He(m));if(u&&!d){const h=n.syncPointTree_.subtree(r);if(!h.isEmpty()){const m=m_(h);for(let p=0;p<m.length;++p){const _=m[p],k=_.query,y=wc(n,_);n.listenProvider_.startListening(Ht(k),en(n,k),y.hashFn,y.onComplete)}}}!d&&c.length>0&&!i&&(u?n.listenProvider_.stopListening(Ht(e),null):c.forEach(h=>{const m=n.queryToTagMap.get(mi(h));n.listenProvider_.stopListening(Ht(h),m)}))}g_(n,c)}return a}function _c(n,e,t,i){const s=ar(n,i);if(s!=null){const r=lr(s),o=r.path,a=r.queryId,l=G(o,e),c=new nt(tr(a),l,t);return cr(n,o,c)}else return[]}function h_(n,e,t,i){const s=ar(n,i);if(s){const r=lr(s),o=r.path,a=r.queryId,l=G(o,e),c=P.fromObject(t),u=new Zt(tr(a),l,c);return cr(n,o,u)}else return[]}function f_(n,e,t,i=!1){const s=e._path;let r=null,o=!1;n.syncPointTree_.foreachOnPath(s,(h,m)=>{const p=G(h,s);r=r||Ue(m,p),o=o||He(m)});let a=n.syncPointTree_.get(s);a?(o=o||He(a),r=r||Ue(a,N())):(a=new uc,n.syncPointTree_=n.syncPointTree_.set(s,a));let l;r!=null?l=!0:(l=!1,r=w.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((m,p)=>{const _=Ue(p,N());_&&(r=r.updateImmediateChild(m,_))}));const c=pc(a,e);if(!c&&!e._queryParams.loadsAllData()){const h=mi(e);g(!n.queryToTagMap.has(h),"View does not exist, but we have a tag");const m=__();n.queryToTagMap.set(h,m),n.tagToQueryMap.set(m,h)}const u=fi(n.pendingWriteTree_,s);let d=s_(a,e,t,u,r,l);if(!c&&!o&&!i){const h=fc(a,e);d=d.concat(y_(n,e,h))}return d}function or(n,e,t){const s=n.pendingWriteTree_,r=n.syncPointTree_.findOnPath(e,(o,a)=>{const l=G(o,e),c=Ue(a,l);if(c)return c});return sc(s,e,r,t,!0)}function p_(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(c,u)=>{const d=G(c,t);i=i||Ue(u,d)});let s=n.syncPointTree_.get(t);s?i=i||Ue(s,N()):(s=new uc,n.syncPointTree_=n.syncPointTree_.set(t,s));const r=i!=null,o=r?new We(i,!0,!1):null,a=fi(n.pendingWriteTree_,e._path),l=dc(s,e,a,r?o.getNode():w.EMPTY_NODE,r);return Qg(l)}function gn(n,e){return yc(e,n.syncPointTree_,null,fi(n.pendingWriteTree_,N()))}function yc(n,e,t,i){if(T(n.path))return vc(n,e,t,i);{const s=e.get(N());t==null&&s!=null&&(t=Ue(s,N()));let r=[];const o=S(n.path),a=n.operationForChild(o),l=e.children.get(o);if(l&&a){const c=t?t.getImmediateChild(o):null,u=rc(i,o);r=r.concat(yc(a,l,c,u))}return s&&(r=r.concat(rr(s,n,i,t))),r}}function vc(n,e,t,i){const s=e.get(N());t==null&&s!=null&&(t=Ue(s,N()));let r=[];return e.children.inorderTraversal((o,a)=>{const l=t?t.getImmediateChild(o):null,c=rc(i,o),u=n.operationForChild(o);u&&(r=r.concat(vc(u,a,l,c)))}),s&&(r=r.concat(rr(s,n,i,t))),r}function wc(n,e){const t=e.query,i=en(n,t);return{hashFn:()=>(Jg(e)||w.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?d_(n,t._path,i):u_(n,t._path);{const r=fm(s,t);return gc(n,t,null,r)}}}}function en(n,e){const t=mi(e);return n.queryToTagMap.get(t)}function mi(n){return n._path.toString()+"$"+n._queryIdentifier}function ar(n,e){return n.tagToQueryMap.get(e)}function lr(n){const e=n.indexOf("$");return g(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new x(n.substr(0,e))}}function cr(n,e,t){const i=n.syncPointTree_.get(e);g(i,"Missing sync point for query tag that we're tracking");const s=fi(n.pendingWriteTree_,e);return rr(i,t,s,null)}function m_(n){return n.fold((e,t,i)=>{if(t&&He(t))return[pi(t)];{let s=[];return t&&(s=hc(t)),Q(i,(r,o)=>{s=s.concat(o)}),s}})}function Ht(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(a_())(n._repo,n._path):n}function g_(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const s=mi(i),r=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(r)}}}function __(){return l_++}function y_(n,e,t){const i=e._path,s=en(n,e),r=wc(n,t),o=n.listenProvider_.startListening(Ht(e),s,r.hashFn,r.onComplete),a=n.syncPointTree_.subtree(i);if(s)g(!He(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,u,d)=>{if(!T(c)&&u&&He(u))return[pi(u).query];{let h=[];return u&&(h=h.concat(hc(u).map(m=>m.query))),Q(d,(m,p)=>{h=h.concat(p)}),h}});for(let c=0;c<l.length;++c){const u=l[c];n.listenProvider_.stopListening(Ht(u),en(n,u))}}return o}class ur{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new ur(t)}node(){return this.node_}}class dr{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=F(this.path_,e);return new dr(this.syncTree_,t)}node(){return or(this.syncTree_,this.path_)}}const v_=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},jo=function(n,e,t){if(!n||typeof n!="object")return n;if(g(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return w_(n[".sv"],e,t);if(typeof n[".sv"]=="object")return b_(n[".sv"],e);g(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},w_=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:g(!1,"Unexpected server value: "+n)}},b_=function(n,e,t){n.hasOwnProperty("increment")||g(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&g(!1,"Unexpected increment value: "+i);const s=e.node();if(g(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const o=s.getValue();return typeof o!="number"?i:o+i},I_=function(n,e,t,i){return hr(e,new dr(t,n),i)},bc=function(n,e,t){return hr(n,new ur(e),t)};function hr(n,e,t){const i=n.getPriority().val(),s=jo(i,e.getImmediateChild(".priority"),t);let r;if(n.isLeafNode()){const o=n,a=jo(o.getValue(),e,t);return a!==o.getValue()||s!==o.getPriority().val()?new B(a,H(s)):n}else{const o=n;return r=o,s!==o.getPriority().val()&&(r=r.updatePriority(new B(s))),o.forEachChild(D,(a,l)=>{const c=hr(l,e.getImmediateChild(a),t);c!==l&&(r=r.updateImmediateChild(a,c))}),r}}class fr{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function pr(n,e){let t=e instanceof x?e:new x(e),i=n,s=S(t);for(;s!==null;){const r=gt(i.node.children,s)||{children:{},childCount:0};i=new fr(s,i,r),t=O(t),s=S(t)}return i}function St(n){return n.node.value}function Ic(n,e){n.node.value=e,ys(n)}function Ec(n){return n.node.childCount>0}function E_(n){return St(n)===void 0&&!Ec(n)}function gi(n,e){Q(n.node.children,(t,i)=>{e(new fr(t,n,i))})}function Cc(n,e,t,i){t&&!i&&e(n),gi(n,s=>{Cc(s,e,!0,i)}),t&&i&&e(n)}function C_(n,e,t){let i=t?n:n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function _n(n){return new x(n.parent===null?n.name:_n(n.parent)+"/"+n.name)}function ys(n){n.parent!==null&&T_(n.parent,n.name,n)}function T_(n,e,t){const i=E_(t),s=Te(n.node.children,e);i&&s?(delete n.node.children[e],n.node.childCount--,ys(n)):!i&&!s&&(n.node.children[e]=t.node,n.node.childCount++,ys(n))}const S_=/[\[\].#$\/\u0000-\u001F\u007F]/,k_=/[\[\].#$\u0000-\u001F\u007F]/,qi=10*1024*1024,Tc=function(n){return typeof n=="string"&&n.length!==0&&!S_.test(n)},Sc=function(n){return typeof n=="string"&&n.length!==0&&!k_.test(n)},R_=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Sc(n)},N_=function(n,e,t,i){i&&e===void 0||mr(Rs(n,"value"),e,t)},mr=function(n,e,t){const i=t instanceof x?new qm(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+$e(i));if(typeof e=="function")throw new Error(n+"contains a function "+$e(i)+" with contents = "+e.toString());if(bl(e))throw new Error(n+"contains "+e.toString()+" "+$e(i));if(typeof e=="string"&&e.length>qi/3&&si(e)>qi)throw new Error(n+"contains a string greater than "+qi+" utf8 bytes "+$e(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,r=!1;if(Q(e,(o,a)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(r=!0,!Tc(o)))throw new Error(n+" contains an invalid key ("+o+") "+$e(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Gm(i,o),mr(n,a,i),Km(i)}),s&&r)throw new Error(n+' contains ".value" child '+$e(i)+" in addition to actual children.")}},kc=function(n,e,t,i){if(!(i&&t===void 0)&&!Sc(t))throw new Error(Rs(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},A_=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),kc(n,e,t,i)},x_=function(n,e){if(S(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},O_=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Tc(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!R_(t))throw new Error(Rs(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};class P_{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Rc(n,e){let t=null;for(let i=0;i<e.length;i++){const s=e[i],r=s.getPath();t!==null&&!Vl(r,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:r}),t.events.push(s)}t&&n.eventLists_.push(t)}function ge(n,e,t){Rc(n,t),D_(n,i=>oe(i,e)||oe(e,i))}function D_(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];if(s){const r=s.path;e(r)?(M_(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function M_(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const i=t.getEventRunner();Ye&&$("event: "+t.toString()),Tt(i)}}}const L_="repo_interrupt",F_=25;class U_{constructor(e,t,i,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new P_,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=qn(),this.transactionQueueTree_=new fr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function B_(n,e,t){if(n.stats_=Ks(n.repoInfo_),n.forceRestClient_||_m())n.server_=new Vn(n.repoInfo_,(i,s,r,o)=>{zo(n,i,s,r,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>$o(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{L(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new be(n.repoInfo_,e,(i,s,r,o)=>{zo(n,i,s,r,o)},i=>{$o(n,i)},i=>{H_(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=Im(n.repoInfo_,()=>new wg(n.stats_,n.server_)),n.infoData_=new mg,n.infoSyncTree_=new Ho({startListening:(i,s,r,o)=>{let a=[];const l=n.infoData_.getNode(i._path);return l.isEmpty()||(a=mn(n.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),_r(n,"connected",!1),n.serverSyncTree_=new Ho({startListening:(i,s,r,o)=>(n.server_.listen(i,r,s,(a,l)=>{const c=o(a,l);ge(n.eventQueue_,i._path,c)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}function W_(n){const t=n.infoData_.getNode(new x(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function gr(n){return v_({timestamp:W_(n)})}function zo(n,e,t,i,s){n.dataUpdateCount++;const r=new x(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(s)if(i){const l=Dn(t,c=>H(c));o=h_(n.serverSyncTree_,r,l,s)}else{const l=H(t);o=_c(n.serverSyncTree_,r,l,s)}else if(i){const l=Dn(t,c=>H(c));o=c_(n.serverSyncTree_,r,l)}else{const l=H(t);o=mn(n.serverSyncTree_,r,l)}let a=r;o.length>0&&(a=yi(n,r)),ge(n.eventQueue_,a,o)}function $o(n,e){_r(n,"connected",e),e===!1&&$_(n)}function H_(n,e){Q(e,(t,i)=>{_r(n,t,i)})}function _r(n,e,t){const i=new x("/.info/"+e),s=H(t);n.infoData_.updateSnapshot(i,s);const r=mn(n.infoSyncTree_,i,s);ge(n.eventQueue_,i,r)}function Nc(n){return n.nextWriteId_++}function j_(n,e,t){const i=p_(n.serverSyncTree_,e);return i!=null?Promise.resolve(i):n.server_.get(e).then(s=>{const r=H(s).withIndex(e._queryParams.getIndex());f_(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=mn(n.serverSyncTree_,e._path,r);else{const a=en(n.serverSyncTree_,e);o=_c(n.serverSyncTree_,e._path,r,a)}return ge(n.eventQueue_,e._path,o),gc(n.serverSyncTree_,e,t,null,!0),r},s=>(_i(n,"get for query "+L(e)+" failed: "+s),Promise.reject(new Error(s))))}function z_(n,e,t,i,s){_i(n,"set",{path:e.toString(),value:t,priority:i});const r=gr(n),o=H(t,i),a=or(n.serverSyncTree_,e),l=bc(o,a,r),c=Nc(n),u=mc(n.serverSyncTree_,e,l,c,!0);Rc(n.eventQueue_,u),n.server_.put(e.toString(),o.val(!0),(h,m)=>{const p=h==="ok";p||J("set at "+e+" failed: "+h);const _=Ge(n.serverSyncTree_,c,!p);ge(n.eventQueue_,e,_),q_(n,s,h,m)});const d=Dc(n,e);yi(n,d),ge(n.eventQueue_,d,[])}function $_(n){_i(n,"onDisconnectEvents");const e=gr(n),t=qn();fs(n.onDisconnect_,N(),(s,r)=>{const o=I_(s,r,n.serverSyncTree_,e);Zl(t,s,o)});let i=[];fs(t,N(),(s,r)=>{i=i.concat(mn(n.serverSyncTree_,s,r));const o=Dc(n,s);yi(n,o)}),n.onDisconnect_=qn(),ge(n.eventQueue_,N(),i)}function V_(n){n.persistentConnection_&&n.persistentConnection_.interrupt(L_)}function _i(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),$(t,...e)}function q_(n,e,t,i){e&&Tt(()=>{if(t==="ok")e(null);else{const s=(t||"error").toUpperCase();let r=s;i&&(r+=": "+i);const o=new Error(r);o.code=s,e(o)}})}function Ac(n,e,t){return or(n.serverSyncTree_,e,t)||w.EMPTY_NODE}function yr(n,e=n.transactionQueueTree_){if(e||vi(n,e),St(e)){const t=Oc(n,e);g(t.length>0,"Sending zero length transaction queue"),t.every(s=>s.status===0)&&G_(n,_n(e),t)}else Ec(e)&&gi(e,t=>{yr(n,t)})}function G_(n,e,t){const i=t.map(c=>c.currentWriteId),s=Ac(n,e,i);let r=s;const o=s.hash();for(let c=0;c<t.length;c++){const u=t[c];g(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const d=G(e,u.path);r=r.updateChild(d,u.currentOutputSnapshotRaw)}const a=r.val(!0),l=e;n.server_.put(l.toString(),a,c=>{_i(n,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){const d=[];for(let h=0;h<t.length;h++)t[h].status=2,u=u.concat(Ge(n.serverSyncTree_,t[h].currentWriteId)),t[h].onComplete&&d.push(()=>t[h].onComplete(null,!0,t[h].currentOutputSnapshotResolved)),t[h].unwatcher();vi(n,pr(n.transactionQueueTree_,e)),yr(n,n.transactionQueueTree_),ge(n.eventQueue_,e,u);for(let h=0;h<d.length;h++)Tt(d[h])}else{if(c==="datastale")for(let d=0;d<t.length;d++)t[d].status===3?t[d].status=4:t[d].status=0;else{J("transaction at "+l.toString()+" failed: "+c);for(let d=0;d<t.length;d++)t[d].status=4,t[d].abortReason=c}yi(n,e)}},o)}function yi(n,e){const t=xc(n,e),i=_n(t),s=Oc(n,t);return K_(n,s,i),i}function K_(n,e,t){if(e.length===0)return;const i=[];let s=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=G(t,l.path);let u=!1,d;if(g(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,d=l.abortReason,s=s.concat(Ge(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=F_)u=!0,d="maxretry",s=s.concat(Ge(n.serverSyncTree_,l.currentWriteId,!0));else{const h=Ac(n,l.path,o);l.currentInputSnapshot=h;const m=e[a].update(h.val());if(m!==void 0){mr("transaction failed: Data returned ",m,l.path);let p=H(m);typeof m=="object"&&m!=null&&Te(m,".priority")||(p=p.updatePriority(h.getPriority()));const k=l.currentWriteId,y=gr(n),I=bc(p,h,y);l.currentOutputSnapshotRaw=p,l.currentOutputSnapshotResolved=I,l.currentWriteId=Nc(n),o.splice(o.indexOf(k),1),s=s.concat(mc(n.serverSyncTree_,l.path,I,l.currentWriteId,l.applyLocally)),s=s.concat(Ge(n.serverSyncTree_,k,!0))}else u=!0,d="nodata",s=s.concat(Ge(n.serverSyncTree_,l.currentWriteId,!0))}ge(n.eventQueue_,t,s),s=[],u&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(d),!1,null))))}vi(n,n.transactionQueueTree_);for(let a=0;a<i.length;a++)Tt(i[a]);yr(n,n.transactionQueueTree_)}function xc(n,e){let t,i=n.transactionQueueTree_;for(t=S(e);t!==null&&St(i)===void 0;)i=pr(i,t),e=O(e),t=S(e);return i}function Oc(n,e){const t=[];return Pc(n,e,t),t.sort((i,s)=>i.order-s.order),t}function Pc(n,e,t){const i=St(e);if(i)for(let s=0;s<i.length;s++)t.push(i[s]);gi(e,s=>{Pc(n,s,t)})}function vi(n,e){const t=St(e);if(t){let i=0;for(let s=0;s<t.length;s++)t[s].status!==2&&(t[i]=t[s],i++);t.length=i,Ic(e,t.length>0?t:void 0)}gi(e,i=>{vi(n,i)})}function Dc(n,e){const t=_n(xc(n,e)),i=pr(n.transactionQueueTree_,e);return C_(i,s=>{Gi(n,s)}),Gi(n,i),Cc(i,s=>{Gi(n,s)}),t}function Gi(n,e){const t=St(e);if(t){const i=[];let s=[],r=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(g(r===o-1,"All SENT items should be at beginning of queue."),r=o,t[o].status=3,t[o].abortReason="set"):(g(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),s=s.concat(Ge(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&i.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));r===-1?Ic(e,void 0):t.length=r+1,ge(n.eventQueue_,_n(e),s);for(let o=0;o<i.length;o++)Tt(i[o])}}function Y_(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let s=t[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function J_(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):J(`Invalid query segment '${t}' in query '${n}'`)}return e}const Vo=function(n,e){const t=Q_(n),i=t.namespace;t.domain==="firebase.com"&&Ce(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&Ce("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||lm();const s=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Pl(t.host,t.secure,i,s,e,"",i!==t.subdomain),path:new x(t.pathString)}},Q_=function(n){let e="",t="",i="",s="",r="",o=!0,a="https",l=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(a=n.substring(0,c-1),n=n.substring(c+2));let u=n.indexOf("/");u===-1&&(u=n.length);let d=n.indexOf("?");d===-1&&(d=n.length),e=n.substring(0,Math.min(u,d)),u<d&&(s=Y_(n.substring(u,d)));const h=J_(n.substring(Math.min(n.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const m=e.slice(0,c);if(m.toLowerCase()==="localhost")t="localhost";else if(m.split(".").length<=2)t=m;else{const p=e.indexOf(".");i=e.substring(0,p).toLowerCase(),t=e.substring(p+1),r=i}"ns"in h&&(r=h.ns)}return{host:e,port:l,domain:t,subdomain:i,secure:o,scheme:a,pathString:s,namespace:r}};class X_{constructor(e,t,i,s){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+L(this.snapshot.exportVal())}}class Z_{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class ey{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return g(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class vr{constructor(e,t,i,s){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=s}get key(){return T(this._path)?null:jl(this._path)}get ref(){return new Se(this._repo,this._path)}get _queryIdentifier(){const e=Ao(this._queryParams),t=qs(e);return t==="{}"?"default":t}get _queryObject(){return Ao(this._queryParams)}isEqual(e){if(e=K(e),!(e instanceof vr))return!1;const t=this._repo===e._repo,i=Vl(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+Vm(this._path)}}class Se extends vr{constructor(e,t){super(e,t,new Zs,!1)}get parent(){const e=$l(this._path);return e===null?null:new Se(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class tn{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new x(e),i=ei(this.ref,e);return new tn(this._node.getChild(t),i,D)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new tn(s,ei(this.ref,i),D)))}hasChild(e){const t=new x(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Mc(n,e){return n=K(n),n._checkNotDeleted("ref"),e!==void 0?ei(n._root,e):n._root}function ei(n,e){return n=K(n),S(n._path)===null?A_("child","path",e,!1):kc("child","path",e,!1),new Se(n._repo,F(n._path,e))}function ty(n,e){n=K(n),x_("set",n._path),N_("set",e,n._path,!1);const t=new ii;return z_(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function ny(n){n=K(n);const e=new ey(()=>{}),t=new wr(e);return j_(n._repo,n,t).then(i=>new tn(i,new Se(n._repo,n._path),n._queryParams.getIndex()))}class wr{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new X_("value",this,new tn(e.snapshotNode,new Se(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Z_(this,e,t):null}matches(e){return e instanceof wr?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}t_(Se);o_(Se);const iy="FIREBASE_DATABASE_EMULATOR_HOST",vs={};let sy=!1;function ry(n,e,t,i){n.repoInfo_=new Pl(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function oy(n,e,t,i,s){let r=i||n.options.databaseURL;r===void 0&&(n.options.projectId||Ce("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),$("Using default host for project ",n.options.projectId),r=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=Vo(r,s),a=o.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[iy]),c?(l=!0,r=`http://${c}?ns=${a.namespace}`,o=Vo(r,s),a=o.repoInfo):l=!o.repoInfo.secure;const u=s&&l?new pt(pt.OWNER):new vm(n.name,n.options,e);O_("Invalid Firebase Database URL",o),T(o.path)||Ce("Database URL must point to the root of a Firebase Database (not including a child path).");const d=ly(a,n,u,new ym(n.name,t));return new cy(d,n)}function ay(n,e){const t=vs[e];(!t||t[n.key]!==n)&&Ce(`Database ${e}(${n.repoInfo_}) has already been deleted.`),V_(n),delete t[n.key]}function ly(n,e,t,i){let s=vs[e.name];s||(s={},vs[e.name]=s);let r=s[n.toURLString()];return r&&Ce("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new U_(n,sy,t,i),s[n.toURLString()]=r,r}class cy{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(B_(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Se(this._repo,N())),this._rootInternal}_delete(){return this._rootInternal!==null&&(ay(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ce("Cannot call "+e+" on a deleted database.")}}function ws(n=xs(),e){const t=ot(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=fu("database");i&&uy(t,...i)}return t}function uy(n,e,t,i={}){n=K(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Ce("Cannot call useEmulator() after instance has already been initialized.");const s=n._repoInternal;let r;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&Ce('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),r=new pt(pt.OWNER);else if(i.mockUserToken){const o=typeof i.mockUserToken=="string"?i.mockUserToken:mu(i.mockUserToken,n.app.options.projectId);r=new pt(o)}ry(s,e,t,r)}function dy(n){im(sn),me(new ce("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return oy(i,s,r,t)},"PUBLIC").setMultipleInstances(!0)),te(fo,po,n),te(fo,po,"esm2017")}be.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};be.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};dy();ee.exports.Notify.init({timeout:2e3,clickToClose:!0});const hy={apiKey:"AIzaSyCAzOEobkX7zjzKcWCZNu8dhUnsurUUSAw",authDomain:"news-goit-1.firebaseapp.com",databaseURL:"https://news-goit-1-default-rtdb.europe-west1.firebasedatabase.app",projectId:"news-goit-1",storageBucket:"news-goit-1.appspot.com",messagingSenderId:"618434101899",appId:"1:618434101899:web:58e5277fd4ec3d55f6ca8e",measurementId:"G-7YDFYWJH4S"},fy=As(hy);ja(fy);Vs();ee.exports.Notify.init({timeout:5e4,clickToClose:!0});const py=function(n){const e=Mc(ws());ny(ei(e,`users/${n}`)).then(t=>{if(t.exists()){const i=t.val();console.log(i),ee.exports.Notify.success(`Команда номер 1 вітає Вас ${i.name}`)}else console.log("No data available")}).catch(t=>{console.error(t)})};ee.exports.Notify.init({timeout:7e3,clickToClose:!0});const De={nameRef:document.getElementById("name"),passRef:document.getElementById("pass"),emailRef:document.getElementById("email"),formRef:document.getElementById("form"),buttonLogin:document.getElementById("login"),buttonRegistr:document.querySelector(".registr"),buttonLogout:document.querySelector(".logout")};Fc();De.formRef.addEventListener("submit",n=>{n.preventDefault(),console.log(n.target.pass.value),console.log(n.target.email.value),Lc(n.target.pass.value,n.target.email.value)});const Lc=function(n,e){const t=Vs();Hf(t,e,n).then(i=>i.user).then(i=>{localStorage.setItem("user",i.uid),Fc(),py(i.uid)}).catch(i=>{i.code;const s=i.message;console.log(s),s==="Firebase: Error (auth/user-not-found)."?ee.exports.Notify.failure("Такого користувача не знайдено. Необхідно зареєструватись"):s==="Firebase: Error (auth/wrong-password)."?ee.exports.Notify.failure("Помилковий пароль"):ee.exports.Notify.failure(`${s}`)})};function Fc(){localStorage.getItem("user")&&(De.buttonRegistr.classList.toggle("displayNone"),De.buttonLogin.classList.toggle("displayNone"),De.buttonLogout.classList.toggle("displayNone"),De.buttonLogout.addEventListener("click",my))}function my(){localStorage.removeItem("user"),De.buttonRegistr.classList.toggle("displayNone"),De.buttonLogin.classList.toggle("displayNone"),De.buttonLogout.classList.toggle("displayNone")}function gy(n,e){ws();const t=ws();ty(Mc(t,"users/"+n),{...e})}const _y={apiKey:"AIzaSyCAzOEobkX7zjzKcWCZNu8dhUnsurUUSAw",authDomain:"news-goit-1.firebaseapp.com",databaseURL:"https://news-goit-1-default-rtdb.europe-west1.firebasedatabase.app",projectId:"news-goit-1",storageBucket:"news-goit-1.appspot.com",messagingSenderId:"618434101899",appId:"1:618434101899:web:58e5277fd4ec3d55f6ca8e",measurementId:"G-7YDFYWJH4S"},yy=As(_y);ja(yy);const vy={nameRef:document.getElementById("nameReg"),passRef:document.getElementById("passReg"),emailRef:document.getElementById("emailReg"),formRef:document.getElementById("formReg")};vy.formRef.addEventListener("submit",n=>{n.preventDefault(),wy(n.target.emailReg.value,n.target.passReg.value,n.target.nameReg.value)});function wy(n,e,t){const i=Vs();Wf(i,n,e).then(s=>{const r=s.user;return ee.exports.Notify.success("Registration successful"),r}).then(s=>(console.log("🚀 ~ user.uid",s.uid),gy(s.uid,{name:t}),s)).then(s=>{Lc(e,s.email)}).catch(s=>{s.code;const r=s.message;console.log(r),r==="Firebase: Error (auth/email-already-in-use)."?ee.exports.Notify.failure("Користувач за таким вже зареєстрований"):r==="Firebase: Password should be at least 6 characters (auth/weak-password)."?(console.log(r),ee.exports.Notify.failure("пароль повинен містити мінімум 6 символів")):(console.log(r),ee.exports.Notify.failure(`${r}`))})}(()=>{const n={openModalBtn:document.querySelector(".registr"),closeModalBtn:document.querySelector("[data-modal-close]"),modal:document.querySelector("[data-modal]"),submitReg:document.querySelector("[data-submitReg]")};n.openModalBtn.addEventListener("click",e),n.closeModalBtn.addEventListener("click",e),n.submitReg.addEventListener("click",e);function e(){n.modal.classList.toggle("is-hidden")}})();(()=>{const n={openModalBtn:document.querySelector(".login"),closeModalBtn:document.querySelector("[data-modal-close-auth]"),modal:document.querySelector("[data-modal-auth]"),submitReg:document.querySelector(".submit-auth")};n.openModalBtn.addEventListener("click",e),n.closeModalBtn.addEventListener("click",e),n.submitReg.addEventListener("click",e);function e(){n.modal.classList.toggle("is-hidden")}})();function Uc(n,e){return function(){return n.apply(e,arguments)}}const{toString:Bc}=Object.prototype,{getPrototypeOf:br}=Object,Ir=(n=>e=>{const t=Bc.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),ke=n=>(n=n.toLowerCase(),e=>Ir(e)===n),wi=n=>e=>typeof e===n,{isArray:kt}=Array,nn=wi("undefined");function by(n){return n!==null&&!nn(n)&&n.constructor!==null&&!nn(n.constructor)&&je(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const Wc=ke("ArrayBuffer");function Iy(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&Wc(n.buffer),e}const Ey=wi("string"),je=wi("function"),Hc=wi("number"),Er=n=>n!==null&&typeof n=="object",Cy=n=>n===!0||n===!1,Rn=n=>{if(Ir(n)!=="object")return!1;const e=br(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Ty=ke("Date"),Sy=ke("File"),ky=ke("Blob"),Ry=ke("FileList"),Ny=n=>Er(n)&&je(n.pipe),Ay=n=>{const e="[object FormData]";return n&&(typeof FormData=="function"&&n instanceof FormData||Bc.call(n)===e||je(n.toString)&&n.toString()===e)},xy=ke("URLSearchParams"),Oy=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function yn(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let i,s;if(typeof n!="object"&&(n=[n]),kt(n))for(i=0,s=n.length;i<s;i++)e.call(null,n[i],i,n);else{const r=t?Object.getOwnPropertyNames(n):Object.keys(n),o=r.length;let a;for(i=0;i<o;i++)a=r[i],e.call(null,n[a],a,n)}}function jc(n,e){e=e.toLowerCase();const t=Object.keys(n);let i=t.length,s;for(;i-- >0;)if(s=t[i],e===s.toLowerCase())return s;return null}const zc=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),$c=n=>!nn(n)&&n!==zc;function bs(){const{caseless:n}=$c(this)&&this||{},e={},t=(i,s)=>{const r=n&&jc(e,s)||s;Rn(e[r])&&Rn(i)?e[r]=bs(e[r],i):Rn(i)?e[r]=bs({},i):kt(i)?e[r]=i.slice():e[r]=i};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&yn(arguments[i],t);return e}const Py=(n,e,t,{allOwnKeys:i}={})=>(yn(e,(s,r)=>{t&&je(s)?n[r]=Uc(s,t):n[r]=s},{allOwnKeys:i}),n),Dy=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),My=(n,e,t,i)=>{n.prototype=Object.create(e.prototype,i),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},Ly=(n,e,t,i)=>{let s,r,o;const a={};if(e=e||{},n==null)return e;do{for(s=Object.getOwnPropertyNames(n),r=s.length;r-- >0;)o=s[r],(!i||i(o,n,e))&&!a[o]&&(e[o]=n[o],a[o]=!0);n=t!==!1&&br(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},Fy=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const i=n.indexOf(e,t);return i!==-1&&i===t},Uy=n=>{if(!n)return null;if(kt(n))return n;let e=n.length;if(!Hc(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},By=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&br(Uint8Array)),Wy=(n,e)=>{const i=(n&&n[Symbol.iterator]).call(n);let s;for(;(s=i.next())&&!s.done;){const r=s.value;e.call(n,r[0],r[1])}},Hy=(n,e)=>{let t;const i=[];for(;(t=n.exec(e))!==null;)i.push(t);return i},jy=ke("HTMLFormElement"),zy=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,s){return i.toUpperCase()+s}),qo=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),$y=ke("RegExp"),Vc=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),i={};yn(t,(s,r)=>{e(s,r,n)!==!1&&(i[r]=s)}),Object.defineProperties(n,i)},Vy=n=>{Vc(n,(e,t)=>{if(je(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=n[t];if(je(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},qy=(n,e)=>{const t={},i=s=>{s.forEach(r=>{t[r]=!0})};return kt(n)?i(n):i(String(n).split(e)),t},Gy=()=>{},Ky=(n,e)=>(n=+n,Number.isFinite(n)?n:e),Ki="abcdefghijklmnopqrstuvwxyz",Go="0123456789",qc={DIGIT:Go,ALPHA:Ki,ALPHA_DIGIT:Ki+Ki.toUpperCase()+Go},Yy=(n=16,e=qc.ALPHA_DIGIT)=>{let t="";const{length:i}=e;for(;n--;)t+=e[Math.random()*i|0];return t};function Jy(n){return!!(n&&je(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator])}const Qy=n=>{const e=new Array(10),t=(i,s)=>{if(Er(i)){if(e.indexOf(i)>=0)return;if(!("toJSON"in i)){e[s]=i;const r=kt(i)?[]:{};return yn(i,(o,a)=>{const l=t(o,s+1);!nn(l)&&(r[a]=l)}),e[s]=void 0,r}}return i};return t(n,0)},f={isArray:kt,isArrayBuffer:Wc,isBuffer:by,isFormData:Ay,isArrayBufferView:Iy,isString:Ey,isNumber:Hc,isBoolean:Cy,isObject:Er,isPlainObject:Rn,isUndefined:nn,isDate:Ty,isFile:Sy,isBlob:ky,isRegExp:$y,isFunction:je,isStream:Ny,isURLSearchParams:xy,isTypedArray:By,isFileList:Ry,forEach:yn,merge:bs,extend:Py,trim:Oy,stripBOM:Dy,inherits:My,toFlatObject:Ly,kindOf:Ir,kindOfTest:ke,endsWith:Fy,toArray:Uy,forEachEntry:Wy,matchAll:Hy,isHTMLForm:jy,hasOwnProperty:qo,hasOwnProp:qo,reduceDescriptors:Vc,freezeMethods:Vy,toObjectSet:qy,toCamelCase:zy,noop:Gy,toFiniteNumber:Ky,findKey:jc,global:zc,isContextDefined:$c,ALPHABET:qc,generateString:Yy,isSpecCompliantForm:Jy,toJSONObject:Qy};function R(n,e,t,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),i&&(this.request=i),s&&(this.response=s)}f.inherits(R,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:f.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Gc=R.prototype,Kc={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{Kc[n]={value:n}});Object.defineProperties(R,Kc);Object.defineProperty(Gc,"isAxiosError",{value:!0});R.from=(n,e,t,i,s,r)=>{const o=Object.create(Gc);return f.toFlatObject(n,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),R.call(o,n.message,e,t,i,s),o.cause=n,o.name=n.name,r&&Object.assign(o,r),o};const Xy=null;function Is(n){return f.isPlainObject(n)||f.isArray(n)}function Yc(n){return f.endsWith(n,"[]")?n.slice(0,-2):n}function Ko(n,e,t){return n?n.concat(e).map(function(s,r){return s=Yc(s),!t&&r?"["+s+"]":s}).join(t?".":""):e}function Zy(n){return f.isArray(n)&&!n.some(Is)}const e0=f.toFlatObject(f,{},null,function(e){return/^is[A-Z]/.test(e)});function bi(n,e,t){if(!f.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=f.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_,k){return!f.isUndefined(k[_])});const i=t.metaTokens,s=t.visitor||u,r=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&f.isSpecCompliantForm(e);if(!f.isFunction(s))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(f.isDate(p))return p.toISOString();if(!l&&f.isBlob(p))throw new R("Blob is not supported. Use a Buffer instead.");return f.isArrayBuffer(p)||f.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,_,k){let y=p;if(p&&!k&&typeof p=="object"){if(f.endsWith(_,"{}"))_=i?_:_.slice(0,-2),p=JSON.stringify(p);else if(f.isArray(p)&&Zy(p)||(f.isFileList(p)||f.endsWith(_,"[]"))&&(y=f.toArray(p)))return _=Yc(_),y.forEach(function(E,X){!(f.isUndefined(E)||E===null)&&e.append(o===!0?Ko([_],X,r):o===null?_:_+"[]",c(E))}),!1}return Is(p)?!0:(e.append(Ko(k,_,r),c(p)),!1)}const d=[],h=Object.assign(e0,{defaultVisitor:u,convertValue:c,isVisitable:Is});function m(p,_){if(!f.isUndefined(p)){if(d.indexOf(p)!==-1)throw Error("Circular reference detected in "+_.join("."));d.push(p),f.forEach(p,function(y,I){(!(f.isUndefined(y)||y===null)&&s.call(e,y,f.isString(I)?I.trim():I,_,h))===!0&&m(y,_?_.concat(I):[I])}),d.pop()}}if(!f.isObject(n))throw new TypeError("data must be an object");return m(n),e}function Yo(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function Cr(n,e){this._pairs=[],n&&bi(n,this,e)}const Jc=Cr.prototype;Jc.append=function(e,t){this._pairs.push([e,t])};Jc.toString=function(e){const t=e?function(i){return e.call(this,i,Yo)}:Yo;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function t0(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Qc(n,e,t){if(!e)return n;const i=t&&t.encode||t0,s=t&&t.serialize;let r;if(s?r=s(e,t):r=f.isURLSearchParams(e)?e.toString():new Cr(e,t).toString(i),r){const o=n.indexOf("#");o!==-1&&(n=n.slice(0,o)),n+=(n.indexOf("?")===-1?"?":"&")+r}return n}class n0{constructor(){this.handlers=[]}use(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){f.forEach(this.handlers,function(i){i!==null&&e(i)})}}const Jo=n0,Xc={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},i0=typeof URLSearchParams<"u"?URLSearchParams:Cr,s0=typeof FormData<"u"?FormData:null,r0=(()=>{let n;return typeof navigator<"u"&&((n=navigator.product)==="ReactNative"||n==="NativeScript"||n==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),o0=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),he={isBrowser:!0,classes:{URLSearchParams:i0,FormData:s0,Blob},isStandardBrowserEnv:r0,isStandardBrowserWebWorkerEnv:o0,protocols:["http","https","file","blob","url","data"]};function a0(n,e){return bi(n,new he.classes.URLSearchParams,Object.assign({visitor:function(t,i,s,r){return he.isNode&&f.isBuffer(t)?(this.append(i,t.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},e))}function l0(n){return f.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function c0(n){const e={},t=Object.keys(n);let i;const s=t.length;let r;for(i=0;i<s;i++)r=t[i],e[r]=n[r];return e}function Zc(n){function e(t,i,s,r){let o=t[r++];const a=Number.isFinite(+o),l=r>=t.length;return o=!o&&f.isArray(s)?s.length:o,l?(f.hasOwnProp(s,o)?s[o]=[s[o],i]:s[o]=i,!a):((!s[o]||!f.isObject(s[o]))&&(s[o]=[]),e(t,i,s[o],r)&&f.isArray(s[o])&&(s[o]=c0(s[o])),!a)}if(f.isFormData(n)&&f.isFunction(n.entries)){const t={};return f.forEachEntry(n,(i,s)=>{e(l0(i),s,t,0)}),t}return null}const u0={"Content-Type":void 0};function d0(n,e,t){if(f.isString(n))try{return(e||JSON.parse)(n),f.trim(n)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(n)}const Ii={transitional:Xc,adapter:["xhr","http"],transformRequest:[function(e,t){const i=t.getContentType()||"",s=i.indexOf("application/json")>-1,r=f.isObject(e);if(r&&f.isHTMLForm(e)&&(e=new FormData(e)),f.isFormData(e))return s&&s?JSON.stringify(Zc(e)):e;if(f.isArrayBuffer(e)||f.isBuffer(e)||f.isStream(e)||f.isFile(e)||f.isBlob(e))return e;if(f.isArrayBufferView(e))return e.buffer;if(f.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(r){if(i.indexOf("application/x-www-form-urlencoded")>-1)return a0(e,this.formSerializer).toString();if((a=f.isFileList(e))||i.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return bi(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return r||s?(t.setContentType("application/json",!1),d0(e)):e}],transformResponse:[function(e){const t=this.transitional||Ii.transitional,i=t&&t.forcedJSONParsing,s=this.responseType==="json";if(e&&f.isString(e)&&(i&&!this.responseType||s)){const o=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?R.from(a,R.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:he.classes.FormData,Blob:he.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};f.forEach(["delete","get","head"],function(e){Ii.headers[e]={}});f.forEach(["post","put","patch"],function(e){Ii.headers[e]=f.merge(u0)});const Tr=Ii,h0=f.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),f0=n=>{const e={};let t,i,s;return n&&n.split(`
`).forEach(function(o){s=o.indexOf(":"),t=o.substring(0,s).trim().toLowerCase(),i=o.substring(s+1).trim(),!(!t||e[t]&&h0[t])&&(t==="set-cookie"?e[t]?e[t].push(i):e[t]=[i]:e[t]=e[t]?e[t]+", "+i:i)}),e},Qo=Symbol("internals");function Pt(n){return n&&String(n).trim().toLowerCase()}function Nn(n){return n===!1||n==null?n:f.isArray(n)?n.map(Nn):String(n)}function p0(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(n);)e[i[1]]=i[2];return e}function m0(n){return/^[-_a-zA-Z]+$/.test(n.trim())}function Yi(n,e,t,i,s){if(f.isFunction(i))return i.call(this,e,t);if(s&&(e=t),!!f.isString(e)){if(f.isString(i))return e.indexOf(i)!==-1;if(f.isRegExp(i))return i.test(e)}}function g0(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,i)=>t.toUpperCase()+i)}function _0(n,e){const t=f.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(n,i+t,{value:function(s,r,o){return this[i].call(this,e,s,r,o)},configurable:!0})})}class Ei{constructor(e){e&&this.set(e)}set(e,t,i){const s=this;function r(a,l,c){const u=Pt(l);if(!u)throw new Error("header name must be a non-empty string");const d=f.findKey(s,u);(!d||s[d]===void 0||c===!0||c===void 0&&s[d]!==!1)&&(s[d||l]=Nn(a))}const o=(a,l)=>f.forEach(a,(c,u)=>r(c,u,l));return f.isPlainObject(e)||e instanceof this.constructor?o(e,t):f.isString(e)&&(e=e.trim())&&!m0(e)?o(f0(e),t):e!=null&&r(t,e,i),this}get(e,t){if(e=Pt(e),e){const i=f.findKey(this,e);if(i){const s=this[i];if(!t)return s;if(t===!0)return p0(s);if(f.isFunction(t))return t.call(this,s,i);if(f.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Pt(e),e){const i=f.findKey(this,e);return!!(i&&this[i]!==void 0&&(!t||Yi(this,this[i],i,t)))}return!1}delete(e,t){const i=this;let s=!1;function r(o){if(o=Pt(o),o){const a=f.findKey(i,o);a&&(!t||Yi(i,i[a],a,t))&&(delete i[a],s=!0)}}return f.isArray(e)?e.forEach(r):r(e),s}clear(e){const t=Object.keys(this);let i=t.length,s=!1;for(;i--;){const r=t[i];(!e||Yi(this,this[r],r,e,!0))&&(delete this[r],s=!0)}return s}normalize(e){const t=this,i={};return f.forEach(this,(s,r)=>{const o=f.findKey(i,r);if(o){t[o]=Nn(s),delete t[r];return}const a=e?g0(r):String(r).trim();a!==r&&delete t[r],t[a]=Nn(s),i[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return f.forEach(this,(i,s)=>{i!=null&&i!==!1&&(t[s]=e&&f.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const i=new this(e);return t.forEach(s=>i.set(s)),i}static accessor(e){const i=(this[Qo]=this[Qo]={accessors:{}}).accessors,s=this.prototype;function r(o){const a=Pt(o);i[a]||(_0(s,o),i[a]=!0)}return f.isArray(e)?e.forEach(r):r(e),this}}Ei.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);f.freezeMethods(Ei.prototype);f.freezeMethods(Ei);const Ie=Ei;function Ji(n,e){const t=this||Tr,i=e||t,s=Ie.from(i.headers);let r=i.data;return f.forEach(n,function(a){r=a.call(t,r,s.normalize(),e?e.status:void 0)}),s.normalize(),r}function eu(n){return!!(n&&n.__CANCEL__)}function vn(n,e,t){R.call(this,n??"canceled",R.ERR_CANCELED,e,t),this.name="CanceledError"}f.inherits(vn,R,{__CANCEL__:!0});function y0(n,e,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?n(t):e(new R("Request failed with status code "+t.status,[R.ERR_BAD_REQUEST,R.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}const v0=he.isStandardBrowserEnv?function(){return{write:function(t,i,s,r,o,a){const l=[];l.push(t+"="+encodeURIComponent(i)),f.isNumber(s)&&l.push("expires="+new Date(s).toGMTString()),f.isString(r)&&l.push("path="+r),f.isString(o)&&l.push("domain="+o),a===!0&&l.push("secure"),document.cookie=l.join("; ")},read:function(t){const i=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function w0(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function b0(n,e){return e?n.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):n}function tu(n,e){return n&&!w0(e)?b0(n,e):e}const I0=he.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let i;function s(r){let o=r;return e&&(t.setAttribute("href",o),o=t.href),t.setAttribute("href",o),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return i=s(window.location.href),function(o){const a=f.isString(o)?s(o):o;return a.protocol===i.protocol&&a.host===i.host}}():function(){return function(){return!0}}();function E0(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function C0(n,e){n=n||10;const t=new Array(n),i=new Array(n);let s=0,r=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=i[r];o||(o=c),t[s]=l,i[s]=c;let d=r,h=0;for(;d!==s;)h+=t[d++],d=d%n;if(s=(s+1)%n,s===r&&(r=(r+1)%n),c-o<e)return;const m=u&&c-u;return m?Math.round(h*1e3/m):void 0}}function Xo(n,e){let t=0;const i=C0(50,250);return s=>{const r=s.loaded,o=s.lengthComputable?s.total:void 0,a=r-t,l=i(a),c=r<=o;t=r;const u={loaded:r,total:o,progress:o?r/o:void 0,bytes:a,rate:l||void 0,estimated:l&&o&&c?(o-r)/l:void 0,event:s};u[e?"download":"upload"]=!0,n(u)}}const T0=typeof XMLHttpRequest<"u",S0=T0&&function(n){return new Promise(function(t,i){let s=n.data;const r=Ie.from(n.headers).normalize(),o=n.responseType;let a;function l(){n.cancelToken&&n.cancelToken.unsubscribe(a),n.signal&&n.signal.removeEventListener("abort",a)}f.isFormData(s)&&(he.isStandardBrowserEnv||he.isStandardBrowserWebWorkerEnv)&&r.setContentType(!1);let c=new XMLHttpRequest;if(n.auth){const m=n.auth.username||"",p=n.auth.password?unescape(encodeURIComponent(n.auth.password)):"";r.set("Authorization","Basic "+btoa(m+":"+p))}const u=tu(n.baseURL,n.url);c.open(n.method.toUpperCase(),Qc(u,n.params,n.paramsSerializer),!0),c.timeout=n.timeout;function d(){if(!c)return;const m=Ie.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders()),_={data:!o||o==="text"||o==="json"?c.responseText:c.response,status:c.status,statusText:c.statusText,headers:m,config:n,request:c};y0(function(y){t(y),l()},function(y){i(y),l()},_),c=null}if("onloadend"in c?c.onloadend=d:c.onreadystatechange=function(){!c||c.readyState!==4||c.status===0&&!(c.responseURL&&c.responseURL.indexOf("file:")===0)||setTimeout(d)},c.onabort=function(){c&&(i(new R("Request aborted",R.ECONNABORTED,n,c)),c=null)},c.onerror=function(){i(new R("Network Error",R.ERR_NETWORK,n,c)),c=null},c.ontimeout=function(){let p=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const _=n.transitional||Xc;n.timeoutErrorMessage&&(p=n.timeoutErrorMessage),i(new R(p,_.clarifyTimeoutError?R.ETIMEDOUT:R.ECONNABORTED,n,c)),c=null},he.isStandardBrowserEnv){const m=(n.withCredentials||I0(u))&&n.xsrfCookieName&&v0.read(n.xsrfCookieName);m&&r.set(n.xsrfHeaderName,m)}s===void 0&&r.setContentType(null),"setRequestHeader"in c&&f.forEach(r.toJSON(),function(p,_){c.setRequestHeader(_,p)}),f.isUndefined(n.withCredentials)||(c.withCredentials=!!n.withCredentials),o&&o!=="json"&&(c.responseType=n.responseType),typeof n.onDownloadProgress=="function"&&c.addEventListener("progress",Xo(n.onDownloadProgress,!0)),typeof n.onUploadProgress=="function"&&c.upload&&c.upload.addEventListener("progress",Xo(n.onUploadProgress)),(n.cancelToken||n.signal)&&(a=m=>{c&&(i(!m||m.type?new vn(null,n,c):m),c.abort(),c=null)},n.cancelToken&&n.cancelToken.subscribe(a),n.signal&&(n.signal.aborted?a():n.signal.addEventListener("abort",a)));const h=E0(u);if(h&&he.protocols.indexOf(h)===-1){i(new R("Unsupported protocol "+h+":",R.ERR_BAD_REQUEST,n));return}c.send(s||null)})},An={http:Xy,xhr:S0};f.forEach(An,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const k0={getAdapter:n=>{n=f.isArray(n)?n:[n];const{length:e}=n;let t,i;for(let s=0;s<e&&(t=n[s],!(i=f.isString(t)?An[t.toLowerCase()]:t));s++);if(!i)throw i===!1?new R(`Adapter ${t} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(f.hasOwnProp(An,t)?`Adapter '${t}' is not available in the build`:`Unknown adapter '${t}'`);if(!f.isFunction(i))throw new TypeError("adapter is not a function");return i},adapters:An};function Qi(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new vn(null,n)}function Zo(n){return Qi(n),n.headers=Ie.from(n.headers),n.data=Ji.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),k0.getAdapter(n.adapter||Tr.adapter)(n).then(function(i){return Qi(n),i.data=Ji.call(n,n.transformResponse,i),i.headers=Ie.from(i.headers),i},function(i){return eu(i)||(Qi(n),i&&i.response&&(i.response.data=Ji.call(n,n.transformResponse,i.response),i.response.headers=Ie.from(i.response.headers))),Promise.reject(i)})}const ea=n=>n instanceof Ie?n.toJSON():n;function wt(n,e){e=e||{};const t={};function i(c,u,d){return f.isPlainObject(c)&&f.isPlainObject(u)?f.merge.call({caseless:d},c,u):f.isPlainObject(u)?f.merge({},u):f.isArray(u)?u.slice():u}function s(c,u,d){if(f.isUndefined(u)){if(!f.isUndefined(c))return i(void 0,c,d)}else return i(c,u,d)}function r(c,u){if(!f.isUndefined(u))return i(void 0,u)}function o(c,u){if(f.isUndefined(u)){if(!f.isUndefined(c))return i(void 0,c)}else return i(void 0,u)}function a(c,u,d){if(d in e)return i(c,u);if(d in n)return i(void 0,c)}const l={url:r,method:r,data:r,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,u)=>s(ea(c),ea(u),!0)};return f.forEach(Object.keys(n).concat(Object.keys(e)),function(u){const d=l[u]||s,h=d(n[u],e[u],u);f.isUndefined(h)&&d!==a||(t[u]=h)}),t}const nu="1.3.3",Sr={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{Sr[n]=function(i){return typeof i===n||"a"+(e<1?"n ":" ")+n}});const ta={};Sr.transitional=function(e,t,i){function s(r,o){return"[Axios v"+nu+"] Transitional option '"+r+"'"+o+(i?". "+i:"")}return(r,o,a)=>{if(e===!1)throw new R(s(o," has been removed"+(t?" in "+t:"")),R.ERR_DEPRECATED);return t&&!ta[o]&&(ta[o]=!0,console.warn(s(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(r,o,a):!0}};function R0(n,e,t){if(typeof n!="object")throw new R("options must be an object",R.ERR_BAD_OPTION_VALUE);const i=Object.keys(n);let s=i.length;for(;s-- >0;){const r=i[s],o=e[r];if(o){const a=n[r],l=a===void 0||o(a,r,n);if(l!==!0)throw new R("option "+r+" must be "+l,R.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new R("Unknown option "+r,R.ERR_BAD_OPTION)}}const Es={assertOptions:R0,validators:Sr},Ne=Es.validators;class ti{constructor(e){this.defaults=e,this.interceptors={request:new Jo,response:new Jo}}request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=wt(this.defaults,t);const{transitional:i,paramsSerializer:s,headers:r}=t;i!==void 0&&Es.assertOptions(i,{silentJSONParsing:Ne.transitional(Ne.boolean),forcedJSONParsing:Ne.transitional(Ne.boolean),clarifyTimeoutError:Ne.transitional(Ne.boolean)},!1),s!==void 0&&Es.assertOptions(s,{encode:Ne.function,serialize:Ne.function},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o;o=r&&f.merge(r.common,r[t.method]),o&&f.forEach(["delete","get","head","post","put","patch","common"],p=>{delete r[p]}),t.headers=Ie.concat(o,r);const a=[];let l=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(t)===!1||(l=l&&_.synchronous,a.unshift(_.fulfilled,_.rejected))});const c=[];this.interceptors.response.forEach(function(_){c.push(_.fulfilled,_.rejected)});let u,d=0,h;if(!l){const p=[Zo.bind(this),void 0];for(p.unshift.apply(p,a),p.push.apply(p,c),h=p.length,u=Promise.resolve(t);d<h;)u=u.then(p[d++],p[d++]);return u}h=a.length;let m=t;for(d=0;d<h;){const p=a[d++],_=a[d++];try{m=p(m)}catch(k){_.call(this,k);break}}try{u=Zo.call(this,m)}catch(p){return Promise.reject(p)}for(d=0,h=c.length;d<h;)u=u.then(c[d++],c[d++]);return u}getUri(e){e=wt(this.defaults,e);const t=tu(e.baseURL,e.url);return Qc(t,e.params,e.paramsSerializer)}}f.forEach(["delete","get","head","options"],function(e){ti.prototype[e]=function(t,i){return this.request(wt(i||{},{method:e,url:t,data:(i||{}).data}))}});f.forEach(["post","put","patch"],function(e){function t(i){return function(r,o,a){return this.request(wt(a||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:r,data:o}))}}ti.prototype[e]=t(),ti.prototype[e+"Form"]=t(!0)});const xn=ti;class kr{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(r){t=r});const i=this;this.promise.then(s=>{if(!i._listeners)return;let r=i._listeners.length;for(;r-- >0;)i._listeners[r](s);i._listeners=null}),this.promise.then=s=>{let r;const o=new Promise(a=>{i.subscribe(a),r=a}).then(s);return o.cancel=function(){i.unsubscribe(r)},o},e(function(r,o,a){i.reason||(i.reason=new vn(r,o,a),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}static source(){let e;return{token:new kr(function(s){e=s}),cancel:e}}}const N0=kr;function A0(n){return function(t){return n.apply(null,t)}}function x0(n){return f.isObject(n)&&n.isAxiosError===!0}const Cs={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Cs).forEach(([n,e])=>{Cs[e]=n});const O0=Cs;function iu(n){const e=new xn(n),t=Uc(xn.prototype.request,e);return f.extend(t,xn.prototype,e,{allOwnKeys:!0}),f.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return iu(wt(n,s))},t}const U=iu(Tr);U.Axios=xn;U.CanceledError=vn;U.CancelToken=N0;U.isCancel=eu;U.VERSION=nu;U.toFormData=bi;U.AxiosError=R;U.Cancel=U.CanceledError;U.all=function(e){return Promise.all(e)};U.spread=A0;U.isAxiosError=x0;U.mergeConfig=wt;U.AxiosHeaders=Ie;U.formToJSON=n=>Zc(f.isHTMLForm(n)?new FormData(n):n);U.HttpStatusCode=O0;U.default=U;const P0=U;async function D0(){try{const n="https://api.nytimes.com/svc//news/v3/content/section-list.json?api-key=",e="2CU5jHC0OFWuoOquTogFU31832ZDQk3X";return(await P0.get(`${n}${e}`)).data.results}catch{}}const su=document.querySelector(".button-categories"),st=document.querySelector(".categories-list"),Rr=document.querySelector(".categories-list-others"),Xi=window.screen.width;let ni=0;W0();function M0(n){const e=[];n.map(t=>{if(e.includes(t.section)){console.log(e);return}else e.push(t.section),Xi<768?L0(Zi(t.section)):Xi>=768&&Xi<1280?F0(Zi(t.section)):U0(Zi(t.section))})}function L0(n){st.classList.add("is-mobil"),st.insertAdjacentHTML("beforeend",`<li class="categories-item"><a class="categories-link">${n}</a></li>`)}function F0(n){if(ni+=1,ni<5){st.classList.add("is-tablet"),st.insertAdjacentHTML("beforeend",`<li class="categories-item-tablet"><a class="categories-link">${n}</a></li>`);return}else Rr.insertAdjacentHTML("beforeend",`<li class="categories-item-tablet-other"><a class="categories-link">${n}</a></li>`)}function U0(n){if(ni+=1,ni<7){st.classList.add("is-desktop"),st.insertAdjacentHTML("beforeend",`<li class="categories-item-tablet"><a class="categories-link">${n}</a></li>`);return}else Rr.insertAdjacentHTML("beforeend",`<li class="categories-item-tablet-other"><a class="categories-link">${n}</a></li>`)}function B0(){st.classList.toggle("is-open"),su.classList.toggle("is-open"),Rr.classList.toggle("is-open")}function W0(){D0().then(M0).catch(console.log("error"))}su.addEventListener("click",B0);function Zi(n){return n[0].toUpperCase()+n.slice(1,n.length)}const H0=document.querySelector(".categories-box");j0();function j0(){H0.addEventListener("click",n=>{n.target.className==="categories-link"&&console.log(n.target.textContent)})}
